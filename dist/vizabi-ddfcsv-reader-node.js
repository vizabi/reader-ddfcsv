!function(t,e){for(var r in e)t[r]=e[r]}(exports,function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},r.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=43)}([function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e){var r=1/0,n=9007199254740991,o=1.7976931348623157e308,i=NaN,a="[object Arguments]",u="[object Function]",c="[object GeneratorFunction]",s="[object String]",f="[object Symbol]",l=/^\s+|\s+$/g,p=/^[-+]0x[0-9a-f]+$/i,h=/^0b[01]+$/i,d=/^0o[0-7]+$/i,_=/^(?:0|[1-9]\d*)$/,y=parseInt;function v(t){return t!=t}function b(t,e){return function(t,e){for(var r=-1,n=t?t.length:0,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}(e,function(e){return t[e]})}var g,m,j=Object.prototype,w=j.hasOwnProperty,O=j.toString,E=j.propertyIsEnumerable,S=(g=Object.keys,m=Object,function(t){return g(m(t))}),A=Math.max;function k(t,e){var r=R(t)||function(t){return function(t){return D(t)&&P(t)}(t)&&w.call(t,"callee")&&(!E.call(t,"callee")||O.call(t)==a)}(t)?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],n=r.length,o=!!n;for(var i in t)!e&&!w.call(t,i)||o&&("length"==i||C(i,n))||r.push(i);return r}function T(t){if(r=(e=t)&&e.constructor,n="function"==typeof r&&r.prototype||j,e!==n)return S(t);var e,r,n,o=[];for(var i in Object(t))w.call(t,i)&&"constructor"!=i&&o.push(i);return o}function C(t,e){return!!(e=null==e?n:e)&&("number"==typeof t||_.test(t))&&t>-1&&t%1==0&&t<e}var R=Array.isArray;function P(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=n}(t.length)&&!function(t){var e=$(t)?O.call(t):"";return e==u||e==c}(t)}function $(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function D(t){return!!t&&"object"==typeof t}t.exports=function(t,e,n,a){var u;t=P(t)?t:(u=t)?b(u,function(t){return P(t)?k(t):T(t)}(u)):[],n=n&&!a?function(t){var e=function(t){if(!t)return 0===t?t:0;if((t=function(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||D(t)&&O.call(t)==f}(t))return i;if($(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=$(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(l,"");var r=h.test(t);return r||d.test(t)?y(t.slice(2),r?2:8):p.test(t)?i:+t}(t))===r||t===-r){var e=t<0?-1:1;return e*o}return t==t?t:0}(t),n=e%1;return e==e?n?e-n:e:0}(n):0;var c=t.length;return n<0&&(n=A(c+n,0)),function(t){return"string"==typeof t||!R(t)&&D(t)&&O.call(t)==s}(t)?n<=c&&t.indexOf(e,n)>-1:!!c&&function(t,e,r){if(e!=e)return function(t,e,r,n){for(var o=t.length,i=r+(n?1:-1);n?i--:++i<o;)if(e(t[i],i,t))return i;return-1}(t,v,r);for(var n=r-1,o=t.length;++n<o;)if(t[n]===e)return n;return-1}(t,e,n)>-1}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(3),o=r(1);e.SCHEMAS=new Set(["concepts.schema","entities.schema","datapoints.schema","*.schema"]),e.DATAPOINTS="datapoints",e.ENTITIES="entities",e.CONCEPTS="concepts",e.CONCEPT_TYPE_MEASURE="measure",e.CONCEPT_TYPE_STRING="string",e.CONCEPT_TYPE_ENTITY_DOMAIN="entity_domain",e.CONCEPT_TYPE_ENTITY_SET="entity_set",e.CONCEPT_TYPE_TIME="time",e.RESERVED_CONCEPT="concept",e.RESERVED_CONCEPT_TYPE="concept_type",e.RESERVED_DOMAIN="domain",e.RESERVED_UNIT="unit",e.RESERVED_DRILL_UP="drill_up",e.RESERVED_KEY="key",e.RESERVED_VALUE="value",e.AVAILABLE_QUERY_OPERATORS=new Set(["$eq","$gt","$gte","$lt","$lte","$ne","$in","$nin","$or","$and","$not","$nor","$size","$all","$elemMatch"]),e.AVAILABLE_FROM_CLAUSE_VALUES=new Set([e.CONCEPTS,e.ENTITIES,e.DATAPOINTS,...e.SCHEMAS]),e.AVAILABLE_ORDER_BY_CLAUSE_VALUES=new Set(["asc","desc",1,-1]),e.DEFAULT_DATASET_NAME=process.env.DEFAULT_DATASET_NAME||"systema_globalis",e.DEFAULT_DATASET_BRANCH=process.env.DEFAULT_DATASET_BRANCH||"master",e.DEFAULT_DATASET_COMMIT="HEAD",e.DEFAULT_DATASET_DIR=process.env.DEFAULT_DATASET_DIR||"./datasets",e.isSchemaQuery=function(t){const r=n(t,"from");return e.SCHEMAS.has(r)},e.isDatapointsQuery=function(t){return n(t,"from")===e.DATAPOINTS},e.isEntitiesQuery=function(t){return n(t,"from")===e.ENTITIES},e.isConceptsQuery=function(t){return n(t,"from")===e.CONCEPTS},e.isEntityDomainOrSet=function(t,e){return o(e,t)},e.isMeasure=function(t){return o([e.CONCEPT_TYPE_MEASURE],t)},e.isIndicator=function(t){return o([e.CONCEPT_TYPE_MEASURE,e.CONCEPT_TYPE_STRING],t)}},function(t,e){var r="Expected a function",n="__lodash_hash_undefined__",o=1/0,i="[object Function]",a="[object GeneratorFunction]",u="[object Symbol]",c=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/,f=/^\./,l=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,p=/\\(\\)?/g,h=/^\[object .+?Constructor\]$/,d="object"==typeof global&&global&&global.Object===Object&&global,_="object"==typeof self&&self&&self.Object===Object&&self,y=d||_||Function("return this")();var v,b=Array.prototype,g=Function.prototype,m=Object.prototype,j=y["__core-js_shared__"],w=(v=/[^.]+$/.exec(j&&j.keys&&j.keys.IE_PROTO||""))?"Symbol(src)_1."+v:"",O=g.toString,E=m.hasOwnProperty,S=m.toString,A=RegExp("^"+O.call(E).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),k=y.Symbol,T=b.splice,C=U(y,"Map"),R=U(Object,"create"),P=k?k.prototype:void 0,$=P?P.toString:void 0;function D(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function x(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function I(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function F(t,e){for(var r,n,o=t.length;o--;)if((r=t[o][0])===(n=e)||r!=r&&n!=n)return o;return-1}function M(t,e){for(var r,n=0,o=(e=function(t,e){if(W(t))return!1;var r=typeof t;if("number"==r||"symbol"==r||"boolean"==r||null==t||G(t))return!0;return s.test(t)||!c.test(t)||null!=e&&t in Object(e)}(e,t)?[e]:W(r=e)?r:V(r)).length;null!=t&&n<o;)t=t[B(e[n++])];return n&&n==o?t:void 0}function L(t){return!(!Q(t)||w&&w in t)&&(function(t){var e=Q(t)?S.call(t):"";return e==i||e==a}(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?A:h).test(function(t){if(null!=t){try{return O.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t))}function N(t,e){var r,n,o=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof e?"string":"hash"]:o.map}function U(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return L(r)?r:void 0}D.prototype.clear=function(){this.__data__=R?R(null):{}},D.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},D.prototype.get=function(t){var e=this.__data__;if(R){var r=e[t];return r===n?void 0:r}return E.call(e,t)?e[t]:void 0},D.prototype.has=function(t){var e=this.__data__;return R?void 0!==e[t]:E.call(e,t)},D.prototype.set=function(t,e){return this.__data__[t]=R&&void 0===e?n:e,this},x.prototype.clear=function(){this.__data__=[]},x.prototype.delete=function(t){var e=this.__data__,r=F(e,t);return!(r<0||(r==e.length-1?e.pop():T.call(e,r,1),0))},x.prototype.get=function(t){var e=this.__data__,r=F(e,t);return r<0?void 0:e[r][1]},x.prototype.has=function(t){return F(this.__data__,t)>-1},x.prototype.set=function(t,e){var r=this.__data__,n=F(r,t);return n<0?r.push([t,e]):r[n][1]=e,this},I.prototype.clear=function(){this.__data__={hash:new D,map:new(C||x),string:new D}},I.prototype.delete=function(t){return N(this,t).delete(t)},I.prototype.get=function(t){return N(this,t).get(t)},I.prototype.has=function(t){return N(this,t).has(t)},I.prototype.set=function(t,e){return N(this,t).set(t,e),this};var V=z(function(t){var e;t=null==(e=t)?"":function(t){if("string"==typeof t)return t;if(G(t))return $?$.call(t):"";var e=t+"";return"0"==e&&1/t==-o?"-0":e}(e);var r=[];return f.test(t)&&r.push(""),t.replace(l,function(t,e,n,o){r.push(n?o.replace(p,"$1"):e||t)}),r});function B(t){if("string"==typeof t||G(t))return t;var e=t+"";return"0"==e&&1/t==-o?"-0":e}function z(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new TypeError(r);var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var a=t.apply(this,r);return n.cache=i.set(o,a),a};return n.cache=new(z.Cache||I),n}z.Cache=I;var W=Array.isArray;function Q(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function G(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&S.call(t)==u}t.exports=function(t,e,r){var n=null==t?void 0:M(t,e);return void 0===n?r:n}},function(t,e,r){(function(t){var r=9007199254740991,n="[object Arguments]",o="[object Function]",i="[object GeneratorFunction]",a="[object Map]",u="[object Set]",c=/^\[object .+?Constructor\]$/,s="object"==typeof global&&global&&global.Object===Object&&global,f="object"==typeof self&&self&&self.Object===Object&&self,l=s||f||Function("return this")(),p="object"==typeof e&&e&&!e.nodeType&&e,h=p&&"object"==typeof t&&t&&!t.nodeType&&t,d=h&&h.exports===p;var _,y,v,b=Function.prototype,g=Object.prototype,m=l["__core-js_shared__"],j=(_=/[^.]+$/.exec(m&&m.keys&&m.keys.IE_PROTO||""))?"Symbol(src)_1."+_:"",w=b.toString,O=g.hasOwnProperty,E=g.toString,S=RegExp("^"+w.call(O).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),A=d?l.Buffer:void 0,k=g.propertyIsEnumerable,T=A?A.isBuffer:void 0,C=(y=Object.keys,v=Object,function(t){return y(v(t))}),R=B(l,"DataView"),P=B(l,"Map"),$=B(l,"Promise"),D=B(l,"Set"),x=B(l,"WeakMap"),I=!k.call({valueOf:1},"valueOf"),F=W(R),M=W(P),L=W($),N=W(D),U=W(x);function V(t){return!(!K(t)||j&&j in t)&&(H(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?S:c).test(W(t))}function B(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return V(r)?r:void 0}var z=function(t){return E.call(t)};function W(t){if(null!=t){try{return w.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Q(t){return function(t){return function(t){return!!t&&"object"==typeof t}(t)&&q(t)}(t)&&O.call(t,"callee")&&(!k.call(t,"callee")||E.call(t)==n)}(R&&"[object DataView]"!=z(new R(new ArrayBuffer(1)))||P&&z(new P)!=a||$&&"[object Promise]"!=z($.resolve())||D&&z(new D)!=u||x&&"[object WeakMap]"!=z(new x))&&(z=function(t){var e=E.call(t),r="[object Object]"==e?t.constructor:void 0,n=r?W(r):void 0;if(n)switch(n){case F:return"[object DataView]";case M:return a;case L:return"[object Promise]";case N:return u;case U:return"[object WeakMap]"}return e});var G=Array.isArray;function q(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=r}(t.length)&&!H(t)}var Y=T||function(){return!1};function H(t){var e=K(t)?E.call(t):"";return e==o||e==i}function K(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}t.exports=function(t){if(q(t)&&(G(t)||"string"==typeof t||"function"==typeof t.splice||Y(t)||Q(t)))return!t.length;var e=z(t);if(e==a||e==u)return!t.size;if(I||function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||g)}(t))return!C(t).length;for(var r in t)if(O.call(t,r))return!1;return!0}}).call(this,r(0)(t))},function(t,e){t.exports=function(t){return null==t}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(18);n.__exportStar(r(2),e),n.__exportStar(r(34),e),n.__exportStar(r(31),e),n.__exportStar(r(23),e),n.__exportStar(r(22),e),n.__exportStar(r(14),e)},function(t,e){t.exports=function(t){for(var e=-1,r=t?t.length:0,n=0,o=[];++e<r;){var i=t[e];i&&(o[n++]=i)}return o}},function(t,e){var r=1/0,n=1.7976931348623157e308,o=NaN,i="[object Symbol]",a=/^\s+|\s+$/g,u=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,s=/^0o[0-7]+$/i,f=parseInt,l="object"==typeof global&&global&&global.Object===Object&&global,p="object"==typeof self&&self&&self.Object===Object&&self,h=l||p||Function("return this")(),d=Object.prototype.toString,_=h.Symbol,y=_?_.prototype:void 0,v=y?y.toString:void 0;function b(t){if("string"==typeof t)return t;if(m(t))return v?v.call(t):"";var e=t+"";return"0"==e&&1/t==-r?"-0":e}function g(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function m(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&d.call(t)==i}function j(t){return t?(t=function(t){if("number"==typeof t)return t;if(m(t))return o;if(g(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=g(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(a,"");var r=c.test(t);return r||s.test(t)?f(t.slice(2),r?2:8):u.test(t)?o:+t}(t))===r||t===-r?(t<0?-1:1)*n:t==t?t:0:0===t?t:0}t.exports=function(t,e,r){var n,o,i,a;return t=null==(n=t)?"":b(n),o=function(t){var e=j(t),r=e%1;return e==e?r?e-r:e:0}(r),i=0,a=t.length,o==o&&(void 0!==a&&(o=o<=a?o:a),void 0!==i&&(o=o>=i?o:i)),r=o,e=b(e),t.slice(r,r+e.length)==e}},function(t,e){var r=9007199254740991,n="[object Arguments]",o="[object Function]",i="[object GeneratorFunction]",a=/^(?:0|[1-9]\d*)$/;var u,c,s=Object.prototype,f=s.hasOwnProperty,l=s.toString,p=s.propertyIsEnumerable,h=(u=Object.keys,c=Object,function(t){return u(c(t))});function d(t,e){var r=v(t)||function(t){return function(t){return function(t){return!!t&&"object"==typeof t}(t)&&b(t)}(t)&&f.call(t,"callee")&&(!p.call(t,"callee")||l.call(t)==n)}(t)?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],o=r.length,i=!!o;for(var a in t)!e&&!f.call(t,a)||i&&("length"==a||y(a,o))||r.push(a);return r}function _(t){if(r=(e=t)&&e.constructor,n="function"==typeof r&&r.prototype||s,e!==n)return h(t);var e,r,n,o=[];for(var i in Object(t))f.call(t,i)&&"constructor"!=i&&o.push(i);return o}function y(t,e){return!!(e=null==e?r:e)&&("number"==typeof t||a.test(t))&&t>-1&&t%1==0&&t<e}var v=Array.isArray;function b(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=r}(t.length)&&!function(t){var e=function(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}(t)?l.call(t):"";return e==o||e==i}(t)}t.exports=function(t){return b(t)?d(t):_(t)}},function(t,e){t.exports=function(t){return t&&t.length?t[0]:void 0}},function(t,e){t.exports=function(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FILE_READING_ERROR="File reading error",e.JSON_PARSING_ERROR="JSON parsing error",e.CSV_PARSING_ERROR="CSV parsing error",e.DDF_ERROR="DDF error";e.DdfCsvError=class extends Error{constructor(t,e,r){super(),this.name="DdfCsvError",this.message=`${t} [filepath: ${r}]. ${e}.`,this.details=e,this.file=r}}},function(t,e,r){var n,o,i;
/*!
	Papa Parse
	v4.3.6
	https://github.com/mholt/PapaParse
	License: MIT
*/o=[],void 0===(i="function"==typeof(n=function(){"use strict";var t,e,r="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==r?r:{},n=!r.document&&!!r.postMessage,o=n&&/(\?|&)papaworker(=|&|$)/.test(r.location.search),i=!1,a={},u=0,c={parse:function(e,n){var o=(n=n||{}).dynamicTyping||!1;if(w(o)&&(n.dynamicTypingFunction=o,o={}),n.dynamicTyping=o,n.worker&&c.WORKERS_SUPPORTED){var s=function(){if(!c.WORKERS_SUPPORTED)return!1;if(!i&&null===c.SCRIPT_PATH)throw new Error("Script path cannot be determined automatically when Papa Parse is loaded asynchronously. You need to set Papa.SCRIPT_PATH manually.");var e=c.SCRIPT_PATH||t;e+=(-1!==e.indexOf("?")?"&":"?")+"papaworker";var n=new r.Worker(e);return n.onmessage=v,n.id=u++,a[n.id]=n,n}();return s.userStep=n.step,s.userChunk=n.chunk,s.userComplete=n.complete,s.userError=n.error,n.step=w(n.step),n.chunk=w(n.chunk),n.complete=w(n.complete),n.error=w(n.error),delete n.worker,void s.postMessage({input:e,config:n,workerId:s.id})}var f=null;return"string"==typeof e?f=n.download?new l(n):new h(n):!0===e.readable&&w(e.read)&&w(e.on)?f=new d(n):(r.File&&e instanceof File||e instanceof Object)&&(f=new p(n)),f.stream(e)},unparse:function(t,e){var r=!1,n=!0,o=",",i="\r\n",a='"';"object"==typeof e&&("string"==typeof e.delimiter&&1===e.delimiter.length&&-1===c.BAD_DELIMITERS.indexOf(e.delimiter)&&(o=e.delimiter),("boolean"==typeof e.quotes||e.quotes instanceof Array)&&(r=e.quotes),"string"==typeof e.newline&&(i=e.newline),"string"==typeof e.quoteChar&&(a=e.quoteChar),"boolean"==typeof e.header&&(n=e.header));var u=new RegExp(a,"g");if("string"==typeof t&&(t=JSON.parse(t)),t instanceof Array){if(!t.length||t[0]instanceof Array)return f(null,t);if("object"==typeof t[0])return f(s(t[0]),t)}else if("object"==typeof t)return"string"==typeof t.data&&(t.data=JSON.parse(t.data)),t.data instanceof Array&&(t.fields||(t.fields=t.meta&&t.meta.fields),t.fields||(t.fields=t.data[0]instanceof Array?t.fields:s(t.data[0])),t.data[0]instanceof Array||"object"==typeof t.data[0]||(t.data=[t.data])),f(t.fields||[],t.data||[]);throw"exception: Unable to serialize unrecognized input";function s(t){if("object"!=typeof t)return[];var e=[];for(var r in t)e.push(r);return e}function f(t,e){var r="";"string"==typeof t&&(t=JSON.parse(t)),"string"==typeof e&&(e=JSON.parse(e));var a=t instanceof Array&&t.length>0,u=!(e[0]instanceof Array);if(a&&n){for(var c=0;c<t.length;c++)c>0&&(r+=o),r+=l(t[c],c);e.length>0&&(r+=i)}for(var s=0;s<e.length;s++){for(var f=a?t.length:e[s].length,p=0;p<f;p++){p>0&&(r+=o);var h=a&&u?t[p]:p;r+=l(e[s][h],p)}s<e.length-1&&(r+=i)}return r}function l(t,e){if(void 0===t||null===t)return"";t=t.toString().replace(u,a+a);var n="boolean"==typeof r&&r||r instanceof Array&&r[e]||function(t,e){for(var r=0;r<e.length;r++)if(t.indexOf(e[r])>-1)return!0;return!1}(t,c.BAD_DELIMITERS)||t.indexOf(o)>-1||" "===t.charAt(0)||" "===t.charAt(t.length-1);return n?a+t+a:t}}};if(c.RECORD_SEP=String.fromCharCode(30),c.UNIT_SEP=String.fromCharCode(31),c.BYTE_ORDER_MARK="\ufeff",c.BAD_DELIMITERS=["\r","\n",'"',c.BYTE_ORDER_MARK],c.WORKERS_SUPPORTED=!n&&!!r.Worker,c.SCRIPT_PATH=null,c.LocalChunkSize=10485760,c.RemoteChunkSize=5242880,c.DefaultDelimiter=",",c.Parser=y,c.ParserHandle=_,c.NetworkStreamer=l,c.FileStreamer=p,c.StringStreamer=h,c.ReadableStreamStreamer=d,r.jQuery){var s=r.jQuery;s.fn.parse=function(t){var e=t.config||{},n=[];return this.each(function(t){var o="INPUT"===s(this).prop("tagName").toUpperCase()&&"file"===s(this).attr("type").toLowerCase()&&r.FileReader;if(!o||!this.files||0===this.files.length)return!0;for(var i=0;i<this.files.length;i++)n.push({file:this.files[i],inputElem:this,instanceConfig:s.extend({},e)})}),o(),this;function o(){if(0!==n.length){var e,r,o,a,u=n[0];if(w(t.before)){var f=t.before(u.file,u.inputElem);if("object"==typeof f){if("abort"===f.action)return e="AbortError",r=u.file,o=u.inputElem,a=f.reason,void(w(t.error)&&t.error({name:e},r,o,a));if("skip"===f.action)return void i();"object"==typeof f.config&&(u.instanceConfig=s.extend(u.instanceConfig,f.config))}else if("skip"===f)return void i()}var l=u.instanceConfig.complete;u.instanceConfig.complete=function(t){w(l)&&l(t,u.file,u.inputElem),i()},c.parse(u.file,u.instanceConfig)}else w(t.complete)&&t.complete()}function i(){n.splice(0,1),o()}}}function f(t){this._handle=null,this._paused=!1,this._finished=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(t){var e=m(t);e.chunkSize=parseInt(e.chunkSize),t.step||t.chunk||(e.chunkSize=null),this._handle=new _(e),this._handle.streamer=this,this._config=e}.call(this,t),this.parseChunk=function(t){if(this.isFirstChunk&&w(this._config.beforeFirstChunk)){var e=this._config.beforeFirstChunk(t);void 0!==e&&(t=e)}this.isFirstChunk=!1;var n=this._partialLine+t;this._partialLine="";var i=this._handle.parse(n,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var a=i.meta.cursor;this._finished||(this._partialLine=n.substring(a-this._baseIndex),this._baseIndex=a),i&&i.data&&(this._rowCount+=i.data.length);var u=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(o)r.postMessage({results:i,workerId:c.WORKER_ID,finished:u});else if(w(this._config.chunk)){if(this._config.chunk(i,this._handle),this._paused)return;i=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(i.data),this._completeResults.errors=this._completeResults.errors.concat(i.errors),this._completeResults.meta=i.meta),!u||!w(this._config.complete)||i&&i.meta.aborted||this._config.complete(this._completeResults,this._input),u||i&&i.meta.paused||this._nextChunk(),i}},this._sendError=function(t){w(this._config.error)?this._config.error(t):o&&this._config.error&&r.postMessage({workerId:c.WORKER_ID,error:t,finished:!1})}}function l(t){var e;(t=t||{}).chunkSize||(t.chunkSize=c.RemoteChunkSize),f.call(this,t),this._nextChunk=n?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(t){this._input=t,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(e=new XMLHttpRequest,this._config.withCredentials&&(e.withCredentials=this._config.withCredentials),n||(e.onload=j(this._chunkLoaded,this),e.onerror=j(this._chunkError,this)),e.open("GET",this._input,!n),this._config.downloadRequestHeaders){var t=this._config.downloadRequestHeaders;for(var r in t)e.setRequestHeader(r,t[r])}if(this._config.chunkSize){var o=this._start+this._config.chunkSize-1;e.setRequestHeader("Range","bytes="+this._start+"-"+o),e.setRequestHeader("If-None-Match","webkit-no-cache")}try{e.send()}catch(t){this._chunkError(t.message)}n&&0===e.status?this._chunkError():this._start+=this._config.chunkSize}},this._chunkLoaded=function(){4==e.readyState&&(e.status<200||e.status>=400?this._chunkError():(this._finished=!this._config.chunkSize||this._start>function(t){var e=t.getResponseHeader("Content-Range");return null===e?-1:parseInt(e.substr(e.lastIndexOf("/")+1))}(e),this.parseChunk(e.responseText)))},this._chunkError=function(t){var r=e.statusText||t;this._sendError(r)}}function p(t){var e,r;(t=t||{}).chunkSize||(t.chunkSize=c.LocalChunkSize),f.call(this,t);var n="undefined"!=typeof FileReader;this.stream=function(t){this._input=t,r=t.slice||t.webkitSlice||t.mozSlice,n?((e=new FileReader).onload=j(this._chunkLoaded,this),e.onerror=j(this._chunkError,this)):e=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var t=this._input;if(this._config.chunkSize){var o=Math.min(this._start+this._config.chunkSize,this._input.size);t=r.call(t,this._start,o)}var i=e.readAsText(t,this._config.encoding);n||this._chunkLoaded({target:{result:i}})},this._chunkLoaded=function(t){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(t.target.result)},this._chunkError=function(){this._sendError(e.error)}}function h(t){var e;t=t||{},f.call(this,t),this.stream=function(t){return e=t,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var t=this._config.chunkSize,r=t?e.substr(0,t):e;return e=t?e.substr(t):"",this._finished=!e,this.parseChunk(r)}}}function d(t){t=t||{},f.call(this,t);var e=[],r=!0;this.stream=function(t){this._input=t,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._nextChunk=function(){e.length?this.parseChunk(e.shift()):r=!0},this._streamData=j(function(t){try{e.push("string"==typeof t?t:t.toString(this._config.encoding)),r&&(r=!1,this.parseChunk(e.shift()))}catch(t){this._streamError(t)}},this),this._streamError=j(function(t){this._streamCleanUp(),this._sendError(t.message)},this),this._streamEnd=j(function(){this._streamCleanUp(),this._finished=!0,this._streamData("")},this),this._streamCleanUp=j(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function _(t){var e,r,n,o=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,i=this,a=0,u=!1,s=!1,f=[],l={data:[],errors:[],meta:{}};if(w(t.step)){var p=t.step;t.step=function(e){if(l=e,d())h();else{if(h(),0===l.data.length)return;a+=e.data.length,t.preview&&a>t.preview?r.abort():p(l,i)}}}function h(){if(l&&n&&(v("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+c.DefaultDelimiter+"'"),n=!1),t.skipEmptyLines)for(var e=0;e<l.data.length;e++)1===l.data[e].length&&""===l.data[e][0]&&l.data.splice(e--,1);return d()&&function(){if(l){for(var t=0;d()&&t<l.data.length;t++)for(var e=0;e<l.data[t].length;e++)f.push(l.data[t][e]);l.data.splice(0,1)}}(),function(){if(!l||!t.header&&!t.dynamicTyping)return l;for(var e=0;e<l.data.length;e++){for(var r=t.header?{}:[],n=0;n<l.data[e].length;n++){var o=n,i=l.data[e][n];t.header&&(o=n>=f.length?"__parsed_extra":f[n]),i=_(o,i),"__parsed_extra"===o?(r[o]=r[o]||[],r[o].push(i)):r[o]=i}l.data[e]=r,t.header&&(n>f.length?v("FieldMismatch","TooManyFields","Too many fields: expected "+f.length+" fields but parsed "+n,e):n<f.length&&v("FieldMismatch","TooFewFields","Too few fields: expected "+f.length+" fields but parsed "+n,e))}return t.header&&l.meta&&(l.meta.fields=f),l}()}function d(){return t.header&&0===f.length}function _(e,r){return function(e){return t.dynamicTypingFunction&&void 0===t.dynamicTyping[e]&&(t.dynamicTyping[e]=t.dynamicTypingFunction(e)),!0===(t.dynamicTyping[e]||t.dynamicTyping)}(e)?"true"===r||"TRUE"===r||"false"!==r&&"FALSE"!==r&&(n=r,o.test(n)?parseFloat(n):n):r;var n}function v(t,e,r,n){l.errors.push({type:t,code:e,message:r,row:n})}this.parse=function(o,i,a){if(t.newline||(t.newline=function(t){var e=(t=t.substr(0,1048576)).split("\r"),r=t.split("\n"),n=r.length>1&&r[0].length<e[0].length;if(1===e.length||n)return"\n";for(var o=0,i=0;i<e.length;i++)"\n"===e[i][0]&&o++;return o>=e.length/2?"\r\n":"\r"}(o)),n=!1,t.delimiter)w(t.delimiter)&&(t.delimiter=t.delimiter(o),l.meta.delimiter=t.delimiter);else{var s=function(e,r,n){for(var o,i,a,u=[",","\t","|",";",c.RECORD_SEP,c.UNIT_SEP],s=0;s<u.length;s++){var f=u[s],l=0,p=0,h=0;a=void 0;for(var d=new y({delimiter:f,newline:r,preview:10}).parse(e),_=0;_<d.data.length;_++)if(n&&1===d.data[_].length&&0===d.data[_][0].length)h++;else{var v=d.data[_].length;p+=v,void 0!==a?v>1&&(l+=Math.abs(v-a),a=v):a=v}d.data.length>0&&(p/=d.data.length-h),(void 0===i||l<i)&&p>1.99&&(i=l,o=f)}return t.delimiter=o,{successful:!!o,bestDelimiter:o}}(o,t.newline,t.skipEmptyLines);s.successful?t.delimiter=s.bestDelimiter:(n=!0,t.delimiter=c.DefaultDelimiter),l.meta.delimiter=t.delimiter}var f=m(t);return t.preview&&t.header&&f.preview++,e=o,r=new y(f),l=r.parse(e,i,a),h(),u?{meta:{paused:!0}}:l||{meta:{paused:!1}}},this.paused=function(){return u},this.pause=function(){u=!0,r.abort(),e=e.substr(r.getCharIndex())},this.resume=function(){u=!1,i.streamer.parseChunk(e)},this.aborted=function(){return s},this.abort=function(){s=!0,r.abort(),l.meta.aborted=!0,w(t.complete)&&t.complete(l),e=""}}function y(t){var e=(t=t||{}).delimiter,r=t.newline,n=t.comments,o=t.step,i=t.preview,a=t.fastMode,u=t.quoteChar||'"';if(("string"!=typeof e||c.BAD_DELIMITERS.indexOf(e)>-1)&&(e=","),n===e)throw"Comment character same as delimiter";!0===n?n="#":("string"!=typeof n||c.BAD_DELIMITERS.indexOf(n)>-1)&&(n=!1),"\n"!=r&&"\r"!=r&&"\r\n"!=r&&(r="\n");var s=0,f=!1;this.parse=function(t,c,l){if("string"!=typeof t)throw"Input must be a string";var p=t.length,h=e.length,d=r.length,_=n.length,y=w(o);s=0;var v=[],b=[],g=[],m=0;if(!t)return $();if(a||!1!==a&&-1===t.indexOf(u)){for(var j=t.split(r),O=0;O<j.length;O++){var g=j[O];if(s+=g.length,O!==j.length-1)s+=r.length;else if(l)return $();if(!n||g.substr(0,_)!==n){if(y){if(v=[],C(g.split(e)),D(),f)return $()}else C(g.split(e));if(i&&O>=i)return v=v.slice(0,i),$(!0)}}return $()}for(var E=t.indexOf(e,s),S=t.indexOf(r,s),A=new RegExp(u+u,"g");;)if(t[s]!==u)if(n&&0===g.length&&t.substr(s,_)===n){if(-1===S)return $();s=S+d,S=t.indexOf(r,s),E=t.indexOf(e,s)}else if(-1!==E&&(E<S||-1===S))g.push(t.substring(s,E)),s=E+h,E=t.indexOf(e,s);else{if(-1===S)break;if(g.push(t.substring(s,S)),P(S+d),y&&(D(),f))return $();if(i&&v.length>=i)return $(!0)}else{var k=s;for(s++;;){var k=t.indexOf(u,k+1);if(-1===k)return l||b.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:v.length,index:s}),R();if(k===p-1){var T=t.substring(s,k).replace(A,u);return R(T)}if(t[k+1]!==u){if(t[k+1]===e){g.push(t.substring(s,k).replace(A,u)),s=k+1+h,E=t.indexOf(e,s),S=t.indexOf(r,s);break}if(t.substr(k+1,d)===r){if(g.push(t.substring(s,k).replace(A,u)),P(k+1+d),E=t.indexOf(e,s),y&&(D(),f))return $();if(i&&v.length>=i)return $(!0);break}b.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:v.length,index:s}),k++}else k++}}return R();function C(t){v.push(t),m=s}function R(e){return l?$():(void 0===e&&(e=t.substr(s)),g.push(e),s=p,C(g),y&&D(),$())}function P(e){s=e,C(g),g=[],S=t.indexOf(r,s)}function $(t){return{data:v,errors:b,meta:{delimiter:e,linebreak:r,aborted:f,truncated:!!t,cursor:m+(c||0)}}}function D(){o($()),v=[],b=[]}},this.abort=function(){f=!0},this.getCharIndex=function(){return s}}function v(t){var e=t.data,r=a[e.workerId],n=!1;if(e.error)r.userError(e.error,e.file);else if(e.results&&e.results.data){var o={abort:function(){n=!0,b(e.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:g,resume:g};if(w(r.userStep)){for(var i=0;i<e.results.data.length&&(r.userStep({data:[e.results.data[i]],errors:e.results.errors,meta:e.results.meta},o),!n);i++);delete e.results}else w(r.userChunk)&&(r.userChunk(e.results,o,e.file),delete e.results)}e.finished&&!n&&b(e.workerId,e.results)}function b(t,e){var r=a[t];w(r.userComplete)&&r.userComplete(e),r.terminate(),delete a[t]}function g(){throw"Not implemented."}function m(t){if("object"!=typeof t)return t;var e=t instanceof Array?[]:{};for(var r in t)e[r]=m(t[r]);return e}function j(t,e){return function(){t.apply(e,arguments)}}function w(t){return"function"==typeof t}return o?r.onmessage=function(t){var e=t.data;if(void 0===c.WORKER_ID&&e&&(c.WORKER_ID=e.workerId),"string"==typeof e.input)r.postMessage({workerId:c.WORKER_ID,results:c.parse(e.input,e.config),finished:!0});else if(r.File&&e.input instanceof File||e.input instanceof Object){var n=c.parse(e.input,e.config);n&&r.postMessage({workerId:c.WORKER_ID,results:n,finished:!0})}}:c.WORKERS_SUPPORTED&&(e=document.getElementsByTagName("script"),t=e.length?e[e.length-1].src:"",document.body?document.addEventListener("DOMContentLoaded",function(){i=!0},!0):i=!0),l.prototype=Object.create(f.prototype),l.prototype.constructor=l,p.prototype=Object.create(f.prototype),p.prototype.constructor=p,h.prototype=Object.create(h.prototype),h.prototype.constructor=h,d.prototype=Object.create(f.prototype),d.prototype.constructor=d,c})?n.apply(e,o):n)||(t.exports=i)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.WhereClauseBasedOnConjunction="WhereClauseBasedOnConjunction",t.ConjunctionPartFromWhereClauseCorrespondsToJoin="ConjunctionPartFromWhereClauseCorrespondsToJoin"}(e.QueryFeature||(e.QueryFeature={}))},function(t,e){t.exports=require("util")},function(t,e,r){(function(t){var r=200,n="Expected a function",o="__lodash_hash_undefined__",i=1,a=2,u=1/0,c=9007199254740991,s="[object Arguments]",f="[object Array]",l="[object Boolean]",p="[object Date]",h="[object Error]",d="[object Function]",_="[object GeneratorFunction]",y="[object Map]",v="[object Number]",b="[object Object]",g="[object RegExp]",m="[object Set]",j="[object String]",w="[object Symbol]",O="[object ArrayBuffer]",E="[object DataView]",S=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,A=/^\w*$/,k=/^\./,T=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,C=/\\(\\)?/g,R=/^\[object .+?Constructor\]$/,P=/^(?:0|[1-9]\d*)$/,$={};$["[object Float32Array]"]=$["[object Float64Array]"]=$["[object Int8Array]"]=$["[object Int16Array]"]=$["[object Int32Array]"]=$["[object Uint8Array]"]=$["[object Uint8ClampedArray]"]=$["[object Uint16Array]"]=$["[object Uint32Array]"]=!0,$[s]=$[f]=$[O]=$[l]=$[E]=$[p]=$[h]=$[d]=$[y]=$[v]=$[b]=$[g]=$[m]=$[j]=$["[object WeakMap]"]=!1;var D="object"==typeof global&&global&&global.Object===Object&&global,x="object"==typeof self&&self&&self.Object===Object&&self,I=D||x||Function("return this")(),F="object"==typeof e&&e&&!e.nodeType&&e,M=F&&"object"==typeof t&&t&&!t.nodeType&&t,L=M&&M.exports===F&&D.process,N=function(){try{return L&&L.binding("util")}catch(t){}}(),U=N&&N.isTypedArray;function V(t,e){for(var r=-1,n=t?t.length:0,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}function B(t,e){for(var r=-1,n=t?t.length:0;++r<n;)if(e(t[r],r,t))return!0;return!1}function z(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}function W(t){var e=-1,r=Array(t.size);return t.forEach(function(t,n){r[++e]=[n,t]}),r}function Q(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r}var G,q,Y,H=Array.prototype,K=Function.prototype,J=Object.prototype,X=I["__core-js_shared__"],Z=(G=/[^.]+$/.exec(X&&X.keys&&X.keys.IE_PROTO||""))?"Symbol(src)_1."+G:"",tt=K.toString,et=J.hasOwnProperty,rt=J.toString,nt=RegExp("^"+tt.call(et).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ot=I.Symbol,it=I.Uint8Array,at=J.propertyIsEnumerable,ut=H.splice,ct=(q=Object.keys,Y=Object,function(t){return q(Y(t))}),st=Wt(I,"DataView"),ft=Wt(I,"Map"),lt=Wt(I,"Promise"),pt=Wt(I,"Set"),ht=Wt(I,"WeakMap"),dt=Wt(Object,"create"),_t=Xt(st),yt=Xt(ft),vt=Xt(lt),bt=Xt(pt),gt=Xt(ht),mt=ot?ot.prototype:void 0,jt=mt?mt.valueOf:void 0,wt=mt?mt.toString:void 0;function Ot(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function Et(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function St(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function At(t){var e=-1,r=t?t.length:0;for(this.__data__=new St;++e<r;)this.add(t[e])}function kt(t){this.__data__=new Et(t)}function Tt(t,e){var r=re(t)||ee(t)?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],n=r.length,o=!!n;for(var i in t)!e&&!et.call(t,i)||o&&("length"==i||Gt(i,n))||r.push(i);return r}function Ct(t,e){for(var r=t.length;r--;)if(te(t[r][0],e))return r;return-1}Ot.prototype.clear=function(){this.__data__=dt?dt(null):{}},Ot.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},Ot.prototype.get=function(t){var e=this.__data__;if(dt){var r=e[t];return r===o?void 0:r}return et.call(e,t)?e[t]:void 0},Ot.prototype.has=function(t){var e=this.__data__;return dt?void 0!==e[t]:et.call(e,t)},Ot.prototype.set=function(t,e){return this.__data__[t]=dt&&void 0===e?o:e,this},Et.prototype.clear=function(){this.__data__=[]},Et.prototype.delete=function(t){var e=this.__data__,r=Ct(e,t);return!(r<0||(r==e.length-1?e.pop():ut.call(e,r,1),0))},Et.prototype.get=function(t){var e=this.__data__,r=Ct(e,t);return r<0?void 0:e[r][1]},Et.prototype.has=function(t){return Ct(this.__data__,t)>-1},Et.prototype.set=function(t,e){var r=this.__data__,n=Ct(r,t);return n<0?r.push([t,e]):r[n][1]=e,this},St.prototype.clear=function(){this.__data__={hash:new Ot,map:new(ft||Et),string:new Ot}},St.prototype.delete=function(t){return zt(this,t).delete(t)},St.prototype.get=function(t){return zt(this,t).get(t)},St.prototype.has=function(t){return zt(this,t).has(t)},St.prototype.set=function(t,e){return zt(this,t).set(t,e),this},At.prototype.add=At.prototype.push=function(t){return this.__data__.set(t,o),this},At.prototype.has=function(t){return this.__data__.has(t)},kt.prototype.clear=function(){this.__data__=new Et},kt.prototype.delete=function(t){return this.__data__.delete(t)},kt.prototype.get=function(t){return this.__data__.get(t)},kt.prototype.has=function(t){return this.__data__.has(t)},kt.prototype.set=function(t,e){var n=this.__data__;if(n instanceof Et){var o=n.__data__;if(!ft||o.length<r-1)return o.push([t,e]),this;n=this.__data__=new St(o)}return n.set(t,e),this};var Rt,Pt,$t=(Rt=function(t,e){return t&&Dt(t,e,fe)},function(t,e){if(null==t)return t;if(!ne(t))return Rt(t,e);for(var r=t.length,n=Pt?r:-1,o=Object(t);(Pt?n--:++n<r)&&!1!==e(o[n],n,o););return t}),Dt=function(t){return function(e,r,n){for(var o=-1,i=Object(e),a=n(e),u=a.length;u--;){var c=a[t?u:++o];if(!1===r(i[c],c,i))break}return e}}();function xt(t,e){for(var r=0,n=(e=qt(e,t)?[e]:Vt(e)).length;null!=t&&r<n;)t=t[Jt(e[r++])];return r&&r==n?t:void 0}function It(t,e){return null!=t&&e in Object(t)}function Ft(t,e,r,n,o){return t===e||(null==t||null==e||!ae(t)&&!ue(e)?t!=t&&e!=e:function(t,e,r,n,o,u){var c=re(t),d=re(e),_=f,S=f;c||(_=(_=Qt(t))==s?b:_);d||(S=(S=Qt(e))==s?b:S);var A=_==b&&!z(t),k=S==b&&!z(e),T=_==S;if(T&&!A)return u||(u=new kt),c||se(t)?Bt(t,e,r,n,o,u):function(t,e,r,n,o,u,c){switch(r){case E:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case O:return!(t.byteLength!=e.byteLength||!n(new it(t),new it(e)));case l:case p:case v:return te(+t,+e);case h:return t.name==e.name&&t.message==e.message;case g:case j:return t==e+"";case y:var s=W;case m:var f=u&a;if(s||(s=Q),t.size!=e.size&&!f)return!1;var d=c.get(t);if(d)return d==e;u|=i,c.set(t,e);var _=Bt(s(t),s(e),n,o,u,c);return c.delete(t),_;case w:if(jt)return jt.call(t)==jt.call(e)}return!1}(t,e,_,r,n,o,u);if(!(o&a)){var C=A&&et.call(t,"__wrapped__"),R=k&&et.call(e,"__wrapped__");if(C||R){var P=C?t.value():t,$=R?e.value():e;return u||(u=new kt),r(P,$,n,o,u)}}if(!T)return!1;return u||(u=new kt),function(t,e,r,n,o,i){var u=o&a,c=fe(t),s=c.length,f=fe(e).length;if(s!=f&&!u)return!1;for(var l=s;l--;){var p=c[l];if(!(u?p in e:et.call(e,p)))return!1}var h=i.get(t);if(h&&i.get(e))return h==e;var d=!0;i.set(t,e),i.set(e,t);for(var _=u;++l<s;){p=c[l];var y=t[p],v=e[p];if(n)var b=u?n(v,y,p,e,t,i):n(y,v,p,t,e,i);if(!(void 0===b?y===v||r(y,v,n,o,i):b)){d=!1;break}_||(_="constructor"==p)}if(d&&!_){var g=t.constructor,m=e.constructor;g!=m&&"constructor"in t&&"constructor"in e&&!("function"==typeof g&&g instanceof g&&"function"==typeof m&&m instanceof m)&&(d=!1)}return i.delete(t),i.delete(e),d}(t,e,r,n,o,u)}(t,e,Ft,r,n,o))}function Mt(t){return!(!ae(t)||Z&&Z in t)&&(oe(t)||z(t)?nt:R).test(Xt(t))}function Lt(t){return"function"==typeof t?t:null==t?le:"object"==typeof t?re(t)?function(t,e){if(qt(t)&&Yt(e))return Ht(Jt(t),e);return function(r){var n=function(t,e,r){var n=null==t?void 0:xt(t,e);return void 0===n?r:n}(r,t);return void 0===n&&n===e?function(t,e){return null!=t&&function(t,e,r){var n,o=-1,i=(e=qt(e,t)?[e]:Vt(e)).length;for(;++o<i;){var a=Jt(e[o]);if(!(n=null!=t&&r(t,a)))break;t=t[a]}if(n)return n;return!!(i=t?t.length:0)&&ie(i)&&Gt(a,i)&&(re(t)||ee(t))}(t,e,It)}(r,t):Ft(e,n,void 0,i|a)}}(t[0],t[1]):function(t){var e=function(t){var e=fe(t),r=e.length;for(;r--;){var n=e[r],o=t[n];e[r]=[n,o,Yt(o)]}return e}(t);if(1==e.length&&e[0][2])return Ht(e[0][0],e[0][1]);return function(r){return r===t||function(t,e,r,n){var o=r.length,u=o,c=!n;if(null==t)return!u;for(t=Object(t);o--;){var s=r[o];if(c&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++o<u;){var f=(s=r[o])[0],l=t[f],p=s[1];if(c&&s[2]){if(void 0===l&&!(f in t))return!1}else{var h=new kt;if(n)var d=n(l,p,f,t,e,h);if(!(void 0===d?Ft(p,l,n,i|a,h):d))return!1}}return!0}(r,t,e)}}(t):qt(e=t)?(r=Jt(e),function(t){return null==t?void 0:t[r]}):function(t){return function(e){return xt(e,t)}}(e);var e,r}function Nt(t){if(r=(e=t)&&e.constructor,n="function"==typeof r&&r.prototype||J,e!==n)return ct(t);var e,r,n,o=[];for(var i in Object(t))et.call(t,i)&&"constructor"!=i&&o.push(i);return o}function Ut(t,e){var r=-1,n=ne(t)?Array(t.length):[];return $t(t,function(t,o,i){n[++r]=e(t,o,i)}),n}function Vt(t){return re(t)?t:Kt(t)}function Bt(t,e,r,n,o,u){var c=o&a,s=t.length,f=e.length;if(s!=f&&!(c&&f>s))return!1;var l=u.get(t);if(l&&u.get(e))return l==e;var p=-1,h=!0,d=o&i?new At:void 0;for(u.set(t,e),u.set(e,t);++p<s;){var _=t[p],y=e[p];if(n)var v=c?n(y,_,p,e,t,u):n(_,y,p,t,e,u);if(void 0!==v){if(v)continue;h=!1;break}if(d){if(!B(e,function(t,e){if(!d.has(e)&&(_===t||r(_,t,n,o,u)))return d.add(e)})){h=!1;break}}else if(_!==y&&!r(_,y,n,o,u)){h=!1;break}}return u.delete(t),u.delete(e),h}function zt(t,e){var r,n,o=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof e?"string":"hash"]:o.map}function Wt(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return Mt(r)?r:void 0}var Qt=function(t){return rt.call(t)};function Gt(t,e){return!!(e=null==e?c:e)&&("number"==typeof t||P.test(t))&&t>-1&&t%1==0&&t<e}function qt(t,e){if(re(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!ce(t))||(A.test(t)||!S.test(t)||null!=e&&t in Object(e))}function Yt(t){return t==t&&!ae(t)}function Ht(t,e){return function(r){return null!=r&&(r[t]===e&&(void 0!==e||t in Object(r)))}}(st&&Qt(new st(new ArrayBuffer(1)))!=E||ft&&Qt(new ft)!=y||lt&&"[object Promise]"!=Qt(lt.resolve())||pt&&Qt(new pt)!=m||ht&&"[object WeakMap]"!=Qt(new ht))&&(Qt=function(t){var e=rt.call(t),r=e==b?t.constructor:void 0,n=r?Xt(r):void 0;if(n)switch(n){case _t:return E;case yt:return y;case vt:return"[object Promise]";case bt:return m;case gt:return"[object WeakMap]"}return e});var Kt=Zt(function(t){var e;t=null==(e=t)?"":function(t){if("string"==typeof t)return t;if(ce(t))return wt?wt.call(t):"";var e=t+"";return"0"==e&&1/t==-u?"-0":e}(e);var r=[];return k.test(t)&&r.push(""),t.replace(T,function(t,e,n,o){r.push(n?o.replace(C,"$1"):e||t)}),r});function Jt(t){if("string"==typeof t||ce(t))return t;var e=t+"";return"0"==e&&1/t==-u?"-0":e}function Xt(t){if(null!=t){try{return tt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Zt(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new TypeError(n);var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=t.apply(this,n);return r.cache=i.set(o,a),a};return r.cache=new(Zt.Cache||St),r}function te(t,e){return t===e||t!=t&&e!=e}function ee(t){return function(t){return ue(t)&&ne(t)}(t)&&et.call(t,"callee")&&(!at.call(t,"callee")||rt.call(t)==s)}Zt.Cache=St;var re=Array.isArray;function ne(t){return null!=t&&ie(t.length)&&!oe(t)}function oe(t){var e=ae(t)?rt.call(t):"";return e==d||e==_}function ie(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=c}function ae(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function ue(t){return!!t&&"object"==typeof t}function ce(t){return"symbol"==typeof t||ue(t)&&rt.call(t)==w}var se=U?function(t){return function(e){return t(e)}}(U):function(t){return ue(t)&&ie(t.length)&&!!$[rt.call(t)]};function fe(t){return ne(t)?Tt(t):Nt(t)}function le(t){return t}t.exports=function(t,e){return(re(t)?V:Ut)(t,Lt(e))}}).call(this,r(0)(t))},function(t,e,r){(function(t){var r=200,n="Expected a function",o="__lodash_hash_undefined__",i=1,a=2,u=1/0,c=9007199254740991,s="[object Arguments]",f="[object Array]",l="[object Boolean]",p="[object Date]",h="[object Error]",d="[object Function]",_="[object GeneratorFunction]",y="[object Map]",v="[object Number]",b="[object Object]",g="[object RegExp]",m="[object Set]",j="[object String]",w="[object Symbol]",O="[object ArrayBuffer]",E="[object DataView]",S=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,A=/^\w*$/,k=/^\./,T=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,C=/\\(\\)?/g,R=/^\[object .+?Constructor\]$/,P=/^(?:0|[1-9]\d*)$/,$={};$["[object Float32Array]"]=$["[object Float64Array]"]=$["[object Int8Array]"]=$["[object Int16Array]"]=$["[object Int32Array]"]=$["[object Uint8Array]"]=$["[object Uint8ClampedArray]"]=$["[object Uint16Array]"]=$["[object Uint32Array]"]=!0,$[s]=$[f]=$[O]=$[l]=$[E]=$[p]=$[h]=$[d]=$[y]=$[v]=$[b]=$[g]=$[m]=$[j]=$["[object WeakMap]"]=!1;var D="object"==typeof global&&global&&global.Object===Object&&global,x="object"==typeof self&&self&&self.Object===Object&&self,I=D||x||Function("return this")(),F="object"==typeof e&&e&&!e.nodeType&&e,M=F&&"object"==typeof t&&t&&!t.nodeType&&t,L=M&&M.exports===F&&D.process,N=function(){try{return L&&L.binding("util")}catch(t){}}(),U=N&&N.isTypedArray;function V(t,e){for(var r=-1,n=t?t.length:0,o=0,i=[];++r<n;){var a=t[r];e(a,r,t)&&(i[o++]=a)}return i}function B(t,e){for(var r=-1,n=t?t.length:0;++r<n;)if(e(t[r],r,t))return!0;return!1}function z(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}function W(t){var e=-1,r=Array(t.size);return t.forEach(function(t,n){r[++e]=[n,t]}),r}function Q(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r}var G,q,Y,H=Array.prototype,K=Function.prototype,J=Object.prototype,X=I["__core-js_shared__"],Z=(G=/[^.]+$/.exec(X&&X.keys&&X.keys.IE_PROTO||""))?"Symbol(src)_1."+G:"",tt=K.toString,et=J.hasOwnProperty,rt=J.toString,nt=RegExp("^"+tt.call(et).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ot=I.Symbol,it=I.Uint8Array,at=J.propertyIsEnumerable,ut=H.splice,ct=(q=Object.keys,Y=Object,function(t){return q(Y(t))}),st=Wt(I,"DataView"),ft=Wt(I,"Map"),lt=Wt(I,"Promise"),pt=Wt(I,"Set"),ht=Wt(I,"WeakMap"),dt=Wt(Object,"create"),_t=Xt(st),yt=Xt(ft),vt=Xt(lt),bt=Xt(pt),gt=Xt(ht),mt=ot?ot.prototype:void 0,jt=mt?mt.valueOf:void 0,wt=mt?mt.toString:void 0;function Ot(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function Et(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function St(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function At(t){var e=-1,r=t?t.length:0;for(this.__data__=new St;++e<r;)this.add(t[e])}function kt(t){this.__data__=new Et(t)}function Tt(t,e){var r=re(t)||ee(t)?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],n=r.length,o=!!n;for(var i in t)!e&&!et.call(t,i)||o&&("length"==i||Gt(i,n))||r.push(i);return r}function Ct(t,e){for(var r=t.length;r--;)if(te(t[r][0],e))return r;return-1}Ot.prototype.clear=function(){this.__data__=dt?dt(null):{}},Ot.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},Ot.prototype.get=function(t){var e=this.__data__;if(dt){var r=e[t];return r===o?void 0:r}return et.call(e,t)?e[t]:void 0},Ot.prototype.has=function(t){var e=this.__data__;return dt?void 0!==e[t]:et.call(e,t)},Ot.prototype.set=function(t,e){return this.__data__[t]=dt&&void 0===e?o:e,this},Et.prototype.clear=function(){this.__data__=[]},Et.prototype.delete=function(t){var e=this.__data__,r=Ct(e,t);return!(r<0||(r==e.length-1?e.pop():ut.call(e,r,1),0))},Et.prototype.get=function(t){var e=this.__data__,r=Ct(e,t);return r<0?void 0:e[r][1]},Et.prototype.has=function(t){return Ct(this.__data__,t)>-1},Et.prototype.set=function(t,e){var r=this.__data__,n=Ct(r,t);return n<0?r.push([t,e]):r[n][1]=e,this},St.prototype.clear=function(){this.__data__={hash:new Ot,map:new(ft||Et),string:new Ot}},St.prototype.delete=function(t){return zt(this,t).delete(t)},St.prototype.get=function(t){return zt(this,t).get(t)},St.prototype.has=function(t){return zt(this,t).has(t)},St.prototype.set=function(t,e){return zt(this,t).set(t,e),this},At.prototype.add=At.prototype.push=function(t){return this.__data__.set(t,o),this},At.prototype.has=function(t){return this.__data__.has(t)},kt.prototype.clear=function(){this.__data__=new Et},kt.prototype.delete=function(t){return this.__data__.delete(t)},kt.prototype.get=function(t){return this.__data__.get(t)},kt.prototype.has=function(t){return this.__data__.has(t)},kt.prototype.set=function(t,e){var n=this.__data__;if(n instanceof Et){var o=n.__data__;if(!ft||o.length<r-1)return o.push([t,e]),this;n=this.__data__=new St(o)}return n.set(t,e),this};var Rt,Pt,$t=(Rt=function(t,e){return t&&xt(t,e,fe)},function(t,e){if(null==t)return t;if(!ne(t))return Rt(t,e);for(var r=t.length,n=Pt?r:-1,o=Object(t);(Pt?n--:++n<r)&&!1!==e(o[n],n,o););return t});function Dt(t,e){var r=[];return $t(t,function(t,n,o){e(t,n,o)&&r.push(t)}),r}var xt=function(t){return function(e,r,n){for(var o=-1,i=Object(e),a=n(e),u=a.length;u--;){var c=a[t?u:++o];if(!1===r(i[c],c,i))break}return e}}();function It(t,e){for(var r=0,n=(e=qt(e,t)?[e]:Vt(e)).length;null!=t&&r<n;)t=t[Jt(e[r++])];return r&&r==n?t:void 0}function Ft(t,e){return null!=t&&e in Object(t)}function Mt(t,e,r,n,o){return t===e||(null==t||null==e||!ae(t)&&!ue(e)?t!=t&&e!=e:function(t,e,r,n,o,u){var c=re(t),d=re(e),_=f,S=f;c||(_=(_=Qt(t))==s?b:_);d||(S=(S=Qt(e))==s?b:S);var A=_==b&&!z(t),k=S==b&&!z(e),T=_==S;if(T&&!A)return u||(u=new kt),c||se(t)?Bt(t,e,r,n,o,u):function(t,e,r,n,o,u,c){switch(r){case E:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case O:return!(t.byteLength!=e.byteLength||!n(new it(t),new it(e)));case l:case p:case v:return te(+t,+e);case h:return t.name==e.name&&t.message==e.message;case g:case j:return t==e+"";case y:var s=W;case m:var f=u&a;if(s||(s=Q),t.size!=e.size&&!f)return!1;var d=c.get(t);if(d)return d==e;u|=i,c.set(t,e);var _=Bt(s(t),s(e),n,o,u,c);return c.delete(t),_;case w:if(jt)return jt.call(t)==jt.call(e)}return!1}(t,e,_,r,n,o,u);if(!(o&a)){var C=A&&et.call(t,"__wrapped__"),R=k&&et.call(e,"__wrapped__");if(C||R){var P=C?t.value():t,$=R?e.value():e;return u||(u=new kt),r(P,$,n,o,u)}}if(!T)return!1;return u||(u=new kt),function(t,e,r,n,o,i){var u=o&a,c=fe(t),s=c.length,f=fe(e).length;if(s!=f&&!u)return!1;for(var l=s;l--;){var p=c[l];if(!(u?p in e:et.call(e,p)))return!1}var h=i.get(t);if(h&&i.get(e))return h==e;var d=!0;i.set(t,e),i.set(e,t);for(var _=u;++l<s;){p=c[l];var y=t[p],v=e[p];if(n)var b=u?n(v,y,p,e,t,i):n(y,v,p,t,e,i);if(!(void 0===b?y===v||r(y,v,n,o,i):b)){d=!1;break}_||(_="constructor"==p)}if(d&&!_){var g=t.constructor,m=e.constructor;g!=m&&"constructor"in t&&"constructor"in e&&!("function"==typeof g&&g instanceof g&&"function"==typeof m&&m instanceof m)&&(d=!1)}return i.delete(t),i.delete(e),d}(t,e,r,n,o,u)}(t,e,Mt,r,n,o))}function Lt(t){return!(!ae(t)||Z&&Z in t)&&(oe(t)||z(t)?nt:R).test(Xt(t))}function Nt(t){return"function"==typeof t?t:null==t?le:"object"==typeof t?re(t)?function(t,e){if(qt(t)&&Yt(e))return Ht(Jt(t),e);return function(r){var n=function(t,e,r){var n=null==t?void 0:It(t,e);return void 0===n?r:n}(r,t);return void 0===n&&n===e?function(t,e){return null!=t&&function(t,e,r){var n,o=-1,i=(e=qt(e,t)?[e]:Vt(e)).length;for(;++o<i;){var a=Jt(e[o]);if(!(n=null!=t&&r(t,a)))break;t=t[a]}if(n)return n;return!!(i=t?t.length:0)&&ie(i)&&Gt(a,i)&&(re(t)||ee(t))}(t,e,Ft)}(r,t):Mt(e,n,void 0,i|a)}}(t[0],t[1]):function(t){var e=function(t){var e=fe(t),r=e.length;for(;r--;){var n=e[r],o=t[n];e[r]=[n,o,Yt(o)]}return e}(t);if(1==e.length&&e[0][2])return Ht(e[0][0],e[0][1]);return function(r){return r===t||function(t,e,r,n){var o=r.length,u=o,c=!n;if(null==t)return!u;for(t=Object(t);o--;){var s=r[o];if(c&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++o<u;){var f=(s=r[o])[0],l=t[f],p=s[1];if(c&&s[2]){if(void 0===l&&!(f in t))return!1}else{var h=new kt;if(n)var d=n(l,p,f,t,e,h);if(!(void 0===d?Mt(p,l,n,i|a,h):d))return!1}}return!0}(r,t,e)}}(t):qt(e=t)?(r=Jt(e),function(t){return null==t?void 0:t[r]}):function(t){return function(e){return It(e,t)}}(e);var e,r}function Ut(t){if(r=(e=t)&&e.constructor,n="function"==typeof r&&r.prototype||J,e!==n)return ct(t);var e,r,n,o=[];for(var i in Object(t))et.call(t,i)&&"constructor"!=i&&o.push(i);return o}function Vt(t){return re(t)?t:Kt(t)}function Bt(t,e,r,n,o,u){var c=o&a,s=t.length,f=e.length;if(s!=f&&!(c&&f>s))return!1;var l=u.get(t);if(l&&u.get(e))return l==e;var p=-1,h=!0,d=o&i?new At:void 0;for(u.set(t,e),u.set(e,t);++p<s;){var _=t[p],y=e[p];if(n)var v=c?n(y,_,p,e,t,u):n(_,y,p,t,e,u);if(void 0!==v){if(v)continue;h=!1;break}if(d){if(!B(e,function(t,e){if(!d.has(e)&&(_===t||r(_,t,n,o,u)))return d.add(e)})){h=!1;break}}else if(_!==y&&!r(_,y,n,o,u)){h=!1;break}}return u.delete(t),u.delete(e),h}function zt(t,e){var r,n,o=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof e?"string":"hash"]:o.map}function Wt(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return Lt(r)?r:void 0}var Qt=function(t){return rt.call(t)};function Gt(t,e){return!!(e=null==e?c:e)&&("number"==typeof t||P.test(t))&&t>-1&&t%1==0&&t<e}function qt(t,e){if(re(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!ce(t))||(A.test(t)||!S.test(t)||null!=e&&t in Object(e))}function Yt(t){return t==t&&!ae(t)}function Ht(t,e){return function(r){return null!=r&&(r[t]===e&&(void 0!==e||t in Object(r)))}}(st&&Qt(new st(new ArrayBuffer(1)))!=E||ft&&Qt(new ft)!=y||lt&&"[object Promise]"!=Qt(lt.resolve())||pt&&Qt(new pt)!=m||ht&&"[object WeakMap]"!=Qt(new ht))&&(Qt=function(t){var e=rt.call(t),r=e==b?t.constructor:void 0,n=r?Xt(r):void 0;if(n)switch(n){case _t:return E;case yt:return y;case vt:return"[object Promise]";case bt:return m;case gt:return"[object WeakMap]"}return e});var Kt=Zt(function(t){var e;t=null==(e=t)?"":function(t){if("string"==typeof t)return t;if(ce(t))return wt?wt.call(t):"";var e=t+"";return"0"==e&&1/t==-u?"-0":e}(e);var r=[];return k.test(t)&&r.push(""),t.replace(T,function(t,e,n,o){r.push(n?o.replace(C,"$1"):e||t)}),r});function Jt(t){if("string"==typeof t||ce(t))return t;var e=t+"";return"0"==e&&1/t==-u?"-0":e}function Xt(t){if(null!=t){try{return tt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Zt(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new TypeError(n);var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=t.apply(this,n);return r.cache=i.set(o,a),a};return r.cache=new(Zt.Cache||St),r}function te(t,e){return t===e||t!=t&&e!=e}function ee(t){return function(t){return ue(t)&&ne(t)}(t)&&et.call(t,"callee")&&(!at.call(t,"callee")||rt.call(t)==s)}Zt.Cache=St;var re=Array.isArray;function ne(t){return null!=t&&ie(t.length)&&!oe(t)}function oe(t){var e=ae(t)?rt.call(t):"";return e==d||e==_}function ie(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=c}function ae(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function ue(t){return!!t&&"object"==typeof t}function ce(t){return"symbol"==typeof t||ue(t)&&rt.call(t)==w}var se=U?function(t){return function(e){return t(e)}}(U):function(t){return ue(t)&&ie(t.length)&&!!$[rt.call(t)]};function fe(t){return ne(t)?Tt(t):Ut(t)}function le(t){return t}t.exports=function(t,e){return(re(t)?V:Dt)(t,Nt(e))}}).call(this,r(0)(t))},function(t,e,r){"use strict";r.r(e),r.d(e,"__extends",function(){return o}),r.d(e,"__assign",function(){return i}),r.d(e,"__rest",function(){return a}),r.d(e,"__decorate",function(){return u}),r.d(e,"__param",function(){return c}),r.d(e,"__metadata",function(){return s}),r.d(e,"__awaiter",function(){return f}),r.d(e,"__generator",function(){return l}),r.d(e,"__exportStar",function(){return p}),r.d(e,"__values",function(){return h}),r.d(e,"__read",function(){return d}),r.d(e,"__spread",function(){return _}),r.d(e,"__await",function(){return y}),r.d(e,"__asyncGenerator",function(){return v}),r.d(e,"__asyncDelegator",function(){return b}),r.d(e,"__asyncValues",function(){return g}),r.d(e,"__makeTemplateObject",function(){return m}),r.d(e,"__importStar",function(){return j}),r.d(e,"__importDefault",function(){return w});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function o(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var i=function(){return(i=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function a(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&(r[n[o]]=t[n[o]])}return r}function u(t,e,r,n){var o,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var u=t.length-1;u>=0;u--)(o=t[u])&&(a=(i<3?o(a):i>3?o(e,r,a):o(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a}function c(t,e){return function(r,n){e(r,n,t)}}function s(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function f(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{c(n.next(t))}catch(t){i(t)}}function u(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(a,u)}c((n=n.apply(t,e||[])).next())})}function l(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}function p(t,e){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}function h(t){var e="function"==typeof Symbol&&t[Symbol.iterator],r=0;return e?e.call(t):{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}}function d(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function _(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(d(arguments[e]));return t}function y(t){return this instanceof y?(this.v=t,this):new y(t)}function v(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(t,e||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(t){o[t]&&(n[t]=function(e){return new Promise(function(r,n){i.push([t,e,r,n])>1||u(t,e)})})}function u(t,e){try{(r=o[t](e)).value instanceof y?Promise.resolve(r.value.v).then(c,s):f(i[0][2],r)}catch(t){f(i[0][3],t)}var r}function c(t){u("next",t)}function s(t){u("throw",t)}function f(t,e){t(e),i.shift(),i.length&&u(i[0][0],i[0][1])}}function b(t){var e,r;return e={},n("next"),n("throw",function(t){throw t}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,o){e[n]=t[n]?function(e){return(r=!r)?{value:y(t[n](e)),done:"return"===n}:o?o(e):e}:o}}function g(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t=h(t),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise(function(n,o){(function(t,e,r,n){Promise.resolve(n).then(function(e){t({value:e,done:r})},e)})(n,o,(e=t[r](e)).done,e.value)})}}}function m(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function j(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function w(t){return t&&t.__esModule?t:{default:t}}},function(t,e){var r=9007199254740991,n="[object Arguments]",o="[object Function]",i="[object GeneratorFunction]",a=/^(?:0|[1-9]\d*)$/;function u(t,e){return function(t,e){for(var r=-1,n=t?t.length:0,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}(e,function(e){return t[e]})}var c,s,f=Object.prototype,l=f.hasOwnProperty,p=f.toString,h=f.propertyIsEnumerable,d=(c=Object.keys,s=Object,function(t){return c(s(t))});function _(t,e){var r=b(t)||function(t){return function(t){return function(t){return!!t&&"object"==typeof t}(t)&&g(t)}(t)&&l.call(t,"callee")&&(!h.call(t,"callee")||p.call(t)==n)}(t)?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],o=r.length,i=!!o;for(var a in t)!e&&!l.call(t,a)||i&&("length"==a||v(a,o))||r.push(a);return r}function y(t){if(r=(e=t)&&e.constructor,n="function"==typeof r&&r.prototype||f,e!==n)return d(t);var e,r,n,o=[];for(var i in Object(t))l.call(t,i)&&"constructor"!=i&&o.push(i);return o}function v(t,e){return!!(e=null==e?r:e)&&("number"==typeof t||a.test(t))&&t>-1&&t%1==0&&t<e}var b=Array.isArray;function g(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=r}(t.length)&&!function(t){var e=function(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}(t)?p.call(t):"";return e==o||e==i}(t)}t.exports=function(t){return t?u(t,function(t){return g(t)?_(t):y(t)}(t)):[]}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.GithubFileReader=class{setRecordTransformer(t){this.recordTransformer=t}readText(t,e){}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(42);e.BackendFileReader=class{setRecordTransformer(t){this.recordTransformer=t}readText(t,e){if(!n.existsSync(t))return e("No such file: "+t);n.readFile(t,"utf-8",(t,r)=>{t?e(t):e(null,r.toString())})}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(9),o=r(11),i=r(10),a=r(2),u=r(14);function c(t){return a.isDatapointsQuery(t)&&1===n(t.where).length&&o(t.where)&&t.where.$and?u.QueryFeature.WhereClauseBasedOnConjunction:null}e.featureDetectors=[c,(t,e)=>{if(!c(t))return null;for(const r of t.where.$and){const o=n(r);if(1===o.length){const a=i(o),c=r[a];if(t.join&&t.join[c]){const r=t.join[c],o=r.where,s=i(n(o));if(r.key===a&&r.key===s&&1===n(o).length){const t=o[s],i=e.get(r.key);if(1===n(t).length&&t.$in&&("entity_set"===i.concept_type||"entity_domain"===i.concept_type))return u.QueryFeature.ConjunctionPartFromWhereClauseCorrespondsToJoin}}}}return null}]},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(18),o=r(5),i=r(1),a=r(3),u=r(2);function c(t,e){const{dataset:r,branch:n,commit:o}=e;return`${t}${r}/${n}-${o}`}function s(t){return t+"/datapackage.json"}e.getDatasetPath=c,e.extendQueryParamWithDatasetProps=function(t,e={}){return n.__awaiter(this,void 0,void 0,function*(){const r=a(e,"datasetsConfig",{[u.DEFAULT_DATASET_NAME]:{[u.DEFAULT_DATASET_BRANCH]:[u.DEFAULT_DATASET_COMMIT]},default:{dataset:u.DEFAULT_DATASET_NAME,branch:u.DEFAULT_DATASET_BRANCH,commit:u.DEFAULT_DATASET_COMMIT}}),{default:{dataset:n,branch:f,commit:l}}=r,{dataset:p,branch:h,commit:d}=t,{dataset:_=n,branch:y=f,commit:v=l}=t,b=a(e,"basePath",u.DEFAULT_DATASET_DIR),g=a(e,"fileReader"),m=_;if(o(r[_]))throw new Error(`No ${o(p)?"default ":""}dataset '${_}' was found`);if(o(r[_][y]))throw new Error(`No ${o(h)?"default ":""}branch '${y}' in ${o(p)?"default ":""}dataset '${_}' was found`);if(!i(r[_][y],v))throw new Error(`No ${o(d)?"default ":""}commit '${v}' in ${o(h)?"default ":""}branch '${y}' in ${o(p)?"default ":""}dataset '${_}' was found`);let j,w;try{(yield function(t,e){return new Promise(r=>{t.readText(s(e),t=>r(!t))})}(g,b))?(j=b,w=s(b)):w=s(j=c(b,{dataset:_,branch:y,commit:v}))}catch(t){throw t}return Object.assign(t,{dataset:_,branch:y,commit:v}),Object.assign(e,{datasetPath:j,datapackagePath:w,datasetName:m}),t})}},function(t,e){var r=200,n="__lodash_hash_undefined__",o="[object Function]",i="[object GeneratorFunction]",a=/^\[object .+?Constructor\]$/,u="object"==typeof global&&global&&global.Object===Object&&global,c="object"==typeof self&&self&&self.Object===Object&&self,s=u||c||Function("return this")();function f(t,e){return!!(t?t.length:0)&&function(t,e,r){if(e!=e)return function(t,e,r,n){var o=t.length,i=r+(n?1:-1);for(;n?i--:++i<o;)if(e(t[i],i,t))return i;return-1}(t,p,r);var n=r-1,o=t.length;for(;++n<o;)if(t[n]===e)return n;return-1}(t,e,0)>-1}function l(t,e,r){for(var n=-1,o=t?t.length:0;++n<o;)if(r(e,t[n]))return!0;return!1}function p(t){return t!=t}function h(t,e){return t.has(e)}function d(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r}var _,y=Array.prototype,v=Function.prototype,b=Object.prototype,g=s["__core-js_shared__"],m=(_=/[^.]+$/.exec(g&&g.keys&&g.keys.IE_PROTO||""))?"Symbol(src)_1."+_:"",j=v.toString,w=b.hasOwnProperty,O=b.toString,E=RegExp("^"+j.call(w).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),S=y.splice,A=M(s,"Map"),k=M(s,"Set"),T=M(Object,"create");function C(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function R(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function P(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function $(t){var e=-1,r=t?t.length:0;for(this.__data__=new P;++e<r;)this.add(t[e])}function D(t,e){for(var r,n,o=t.length;o--;)if((r=t[o][0])===(n=e)||r!=r&&n!=n)return o;return-1}function x(t){return!(!L(t)||m&&m in t)&&(function(t){var e=L(t)?O.call(t):"";return e==o||e==i}(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?E:a).test(function(t){if(null!=t){try{return j.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t))}C.prototype.clear=function(){this.__data__=T?T(null):{}},C.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},C.prototype.get=function(t){var e=this.__data__;if(T){var r=e[t];return r===n?void 0:r}return w.call(e,t)?e[t]:void 0},C.prototype.has=function(t){var e=this.__data__;return T?void 0!==e[t]:w.call(e,t)},C.prototype.set=function(t,e){return this.__data__[t]=T&&void 0===e?n:e,this},R.prototype.clear=function(){this.__data__=[]},R.prototype.delete=function(t){var e=this.__data__,r=D(e,t);return!(r<0||(r==e.length-1?e.pop():S.call(e,r,1),0))},R.prototype.get=function(t){var e=this.__data__,r=D(e,t);return r<0?void 0:e[r][1]},R.prototype.has=function(t){return D(this.__data__,t)>-1},R.prototype.set=function(t,e){var r=this.__data__,n=D(r,t);return n<0?r.push([t,e]):r[n][1]=e,this},P.prototype.clear=function(){this.__data__={hash:new C,map:new(A||R),string:new C}},P.prototype.delete=function(t){return F(this,t).delete(t)},P.prototype.get=function(t){return F(this,t).get(t)},P.prototype.has=function(t){return F(this,t).has(t)},P.prototype.set=function(t,e){return F(this,t).set(t,e),this},$.prototype.add=$.prototype.push=function(t){return this.__data__.set(t,n),this},$.prototype.has=function(t){return this.__data__.has(t)};var I=k&&1/d(new k([,-0]))[1]==1/0?function(t){return new k(t)}:function(){};function F(t,e){var r,n,o=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof e?"string":"hash"]:o.map}function M(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return x(r)?r:void 0}function L(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}t.exports=function(t){return t&&t.length?function(t,e,n){var o=-1,i=f,a=t.length,u=!0,c=[],s=c;if(n)u=!1,i=l;else if(a>=r){var p=e?null:I(t);if(p)return d(p);u=!1,i=h,s=new $}else s=e?[]:c;t:for(;++o<a;){var _=t[o],y=e?e(_):_;if(_=n||0!==_?_:0,u&&y==y){for(var v=s.length;v--;)if(s[v]===y)continue t;e&&s.push(y),c.push(_)}else i(s,y,n)||(s!==c&&s.push(y),c.push(_))}return c}(t):[]}},function(t,e){var r="[object String]",n=Object.prototype.toString,o=Array.isArray;t.exports=function(t){return"string"==typeof t||!o(t)&&function(t){return!!t&&"object"==typeof t}(t)&&n.call(t)==r}},function(t,e,r){(function(t){var r=200,n="Expected a function",o="__lodash_hash_undefined__",i=1,a=2,u=1/0,c=9007199254740991,s="[object Arguments]",f="[object Array]",l="[object Boolean]",p="[object Date]",h="[object Error]",d="[object Function]",_="[object GeneratorFunction]",y="[object Map]",v="[object Number]",b="[object Object]",g="[object RegExp]",m="[object Set]",j="[object String]",w="[object Symbol]",O="[object ArrayBuffer]",E="[object DataView]",S=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,A=/^\w*$/,k=/^\./,T=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,C=/\\(\\)?/g,R=/^\[object .+?Constructor\]$/,P=/^(?:0|[1-9]\d*)$/,$={};$["[object Float32Array]"]=$["[object Float64Array]"]=$["[object Int8Array]"]=$["[object Int16Array]"]=$["[object Int32Array]"]=$["[object Uint8Array]"]=$["[object Uint8ClampedArray]"]=$["[object Uint16Array]"]=$["[object Uint32Array]"]=!0,$[s]=$[f]=$[O]=$[l]=$[E]=$[p]=$[h]=$[d]=$[y]=$[v]=$[b]=$[g]=$[m]=$[j]=$["[object WeakMap]"]=!1;var D="object"==typeof global&&global&&global.Object===Object&&global,x="object"==typeof self&&self&&self.Object===Object&&self,I=D||x||Function("return this")(),F="object"==typeof e&&e&&!e.nodeType&&e,M=F&&"object"==typeof t&&t&&!t.nodeType&&t,L=M&&M.exports===F&&D.process,N=function(){try{return L&&L.binding("util")}catch(t){}}(),U=N&&N.isTypedArray;function V(t,e){for(var r=-1,n=t?t.length:0;++r<n;)if(!e(t[r],r,t))return!1;return!0}function B(t,e){for(var r=-1,n=t?t.length:0;++r<n;)if(e(t[r],r,t))return!0;return!1}function z(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}function W(t){var e=-1,r=Array(t.size);return t.forEach(function(t,n){r[++e]=[n,t]}),r}function Q(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r}var G,q,Y,H=Array.prototype,K=Function.prototype,J=Object.prototype,X=I["__core-js_shared__"],Z=(G=/[^.]+$/.exec(X&&X.keys&&X.keys.IE_PROTO||""))?"Symbol(src)_1."+G:"",tt=K.toString,et=J.hasOwnProperty,rt=J.toString,nt=RegExp("^"+tt.call(et).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ot=I.Symbol,it=I.Uint8Array,at=J.propertyIsEnumerable,ut=H.splice,ct=(q=Object.keys,Y=Object,function(t){return q(Y(t))}),st=Wt(I,"DataView"),ft=Wt(I,"Map"),lt=Wt(I,"Promise"),pt=Wt(I,"Set"),ht=Wt(I,"WeakMap"),dt=Wt(Object,"create"),_t=Xt(st),yt=Xt(ft),vt=Xt(lt),bt=Xt(pt),gt=Xt(ht),mt=ot?ot.prototype:void 0,jt=mt?mt.valueOf:void 0,wt=mt?mt.toString:void 0;function Ot(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function Et(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function St(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function At(t){var e=-1,r=t?t.length:0;for(this.__data__=new St;++e<r;)this.add(t[e])}function kt(t){this.__data__=new Et(t)}function Tt(t,e){var r=re(t)||ee(t)?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],n=r.length,o=!!n;for(var i in t)!e&&!et.call(t,i)||o&&("length"==i||Gt(i,n))||r.push(i);return r}function Ct(t,e){for(var r=t.length;r--;)if(te(t[r][0],e))return r;return-1}Ot.prototype.clear=function(){this.__data__=dt?dt(null):{}},Ot.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},Ot.prototype.get=function(t){var e=this.__data__;if(dt){var r=e[t];return r===o?void 0:r}return et.call(e,t)?e[t]:void 0},Ot.prototype.has=function(t){var e=this.__data__;return dt?void 0!==e[t]:et.call(e,t)},Ot.prototype.set=function(t,e){return this.__data__[t]=dt&&void 0===e?o:e,this},Et.prototype.clear=function(){this.__data__=[]},Et.prototype.delete=function(t){var e=this.__data__,r=Ct(e,t);return!(r<0||(r==e.length-1?e.pop():ut.call(e,r,1),0))},Et.prototype.get=function(t){var e=this.__data__,r=Ct(e,t);return r<0?void 0:e[r][1]},Et.prototype.has=function(t){return Ct(this.__data__,t)>-1},Et.prototype.set=function(t,e){var r=this.__data__,n=Ct(r,t);return n<0?r.push([t,e]):r[n][1]=e,this},St.prototype.clear=function(){this.__data__={hash:new Ot,map:new(ft||Et),string:new Ot}},St.prototype.delete=function(t){return zt(this,t).delete(t)},St.prototype.get=function(t){return zt(this,t).get(t)},St.prototype.has=function(t){return zt(this,t).has(t)},St.prototype.set=function(t,e){return zt(this,t).set(t,e),this},At.prototype.add=At.prototype.push=function(t){return this.__data__.set(t,o),this},At.prototype.has=function(t){return this.__data__.has(t)},kt.prototype.clear=function(){this.__data__=new Et},kt.prototype.delete=function(t){return this.__data__.delete(t)},kt.prototype.get=function(t){return this.__data__.get(t)},kt.prototype.has=function(t){return this.__data__.has(t)},kt.prototype.set=function(t,e){var n=this.__data__;if(n instanceof Et){var o=n.__data__;if(!ft||o.length<r-1)return o.push([t,e]),this;n=this.__data__=new St(o)}return n.set(t,e),this};var Rt,Pt,$t=(Rt=function(t,e){return t&&xt(t,e,fe)},function(t,e){if(null==t)return t;if(!ne(t))return Rt(t,e);for(var r=t.length,n=Pt?r:-1,o=Object(t);(Pt?n--:++n<r)&&!1!==e(o[n],n,o););return t});function Dt(t,e){var r=!0;return $t(t,function(t,n,o){return r=!!e(t,n,o)}),r}var xt=function(t){return function(e,r,n){for(var o=-1,i=Object(e),a=n(e),u=a.length;u--;){var c=a[t?u:++o];if(!1===r(i[c],c,i))break}return e}}();function It(t,e){for(var r=0,n=(e=qt(e,t)?[e]:Vt(e)).length;null!=t&&r<n;)t=t[Jt(e[r++])];return r&&r==n?t:void 0}function Ft(t,e){return null!=t&&e in Object(t)}function Mt(t,e,r,n,o){return t===e||(null==t||null==e||!ae(t)&&!ue(e)?t!=t&&e!=e:function(t,e,r,n,o,u){var c=re(t),d=re(e),_=f,S=f;c||(_=(_=Qt(t))==s?b:_);d||(S=(S=Qt(e))==s?b:S);var A=_==b&&!z(t),k=S==b&&!z(e),T=_==S;if(T&&!A)return u||(u=new kt),c||se(t)?Bt(t,e,r,n,o,u):function(t,e,r,n,o,u,c){switch(r){case E:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case O:return!(t.byteLength!=e.byteLength||!n(new it(t),new it(e)));case l:case p:case v:return te(+t,+e);case h:return t.name==e.name&&t.message==e.message;case g:case j:return t==e+"";case y:var s=W;case m:var f=u&a;if(s||(s=Q),t.size!=e.size&&!f)return!1;var d=c.get(t);if(d)return d==e;u|=i,c.set(t,e);var _=Bt(s(t),s(e),n,o,u,c);return c.delete(t),_;case w:if(jt)return jt.call(t)==jt.call(e)}return!1}(t,e,_,r,n,o,u);if(!(o&a)){var C=A&&et.call(t,"__wrapped__"),R=k&&et.call(e,"__wrapped__");if(C||R){var P=C?t.value():t,$=R?e.value():e;return u||(u=new kt),r(P,$,n,o,u)}}if(!T)return!1;return u||(u=new kt),function(t,e,r,n,o,i){var u=o&a,c=fe(t),s=c.length,f=fe(e).length;if(s!=f&&!u)return!1;for(var l=s;l--;){var p=c[l];if(!(u?p in e:et.call(e,p)))return!1}var h=i.get(t);if(h&&i.get(e))return h==e;var d=!0;i.set(t,e),i.set(e,t);for(var _=u;++l<s;){p=c[l];var y=t[p],v=e[p];if(n)var b=u?n(v,y,p,e,t,i):n(y,v,p,t,e,i);if(!(void 0===b?y===v||r(y,v,n,o,i):b)){d=!1;break}_||(_="constructor"==p)}if(d&&!_){var g=t.constructor,m=e.constructor;g!=m&&"constructor"in t&&"constructor"in e&&!("function"==typeof g&&g instanceof g&&"function"==typeof m&&m instanceof m)&&(d=!1)}return i.delete(t),i.delete(e),d}(t,e,r,n,o,u)}(t,e,Mt,r,n,o))}function Lt(t){return!(!ae(t)||Z&&Z in t)&&(oe(t)||z(t)?nt:R).test(Xt(t))}function Nt(t){return"function"==typeof t?t:null==t?le:"object"==typeof t?re(t)?function(t,e){if(qt(t)&&Yt(e))return Ht(Jt(t),e);return function(r){var n=function(t,e,r){var n=null==t?void 0:It(t,e);return void 0===n?r:n}(r,t);return void 0===n&&n===e?function(t,e){return null!=t&&function(t,e,r){var n,o=-1,i=(e=qt(e,t)?[e]:Vt(e)).length;for(;++o<i;){var a=Jt(e[o]);if(!(n=null!=t&&r(t,a)))break;t=t[a]}if(n)return n;return!!(i=t?t.length:0)&&ie(i)&&Gt(a,i)&&(re(t)||ee(t))}(t,e,Ft)}(r,t):Mt(e,n,void 0,i|a)}}(t[0],t[1]):function(t){var e=function(t){var e=fe(t),r=e.length;for(;r--;){var n=e[r],o=t[n];e[r]=[n,o,Yt(o)]}return e}(t);if(1==e.length&&e[0][2])return Ht(e[0][0],e[0][1]);return function(r){return r===t||function(t,e,r,n){var o=r.length,u=o,c=!n;if(null==t)return!u;for(t=Object(t);o--;){var s=r[o];if(c&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++o<u;){var f=(s=r[o])[0],l=t[f],p=s[1];if(c&&s[2]){if(void 0===l&&!(f in t))return!1}else{var h=new kt;if(n)var d=n(l,p,f,t,e,h);if(!(void 0===d?Mt(p,l,n,i|a,h):d))return!1}}return!0}(r,t,e)}}(t):qt(e=t)?(r=Jt(e),function(t){return null==t?void 0:t[r]}):function(t){return function(e){return It(e,t)}}(e);var e,r}function Ut(t){if(r=(e=t)&&e.constructor,n="function"==typeof r&&r.prototype||J,e!==n)return ct(t);var e,r,n,o=[];for(var i in Object(t))et.call(t,i)&&"constructor"!=i&&o.push(i);return o}function Vt(t){return re(t)?t:Kt(t)}function Bt(t,e,r,n,o,u){var c=o&a,s=t.length,f=e.length;if(s!=f&&!(c&&f>s))return!1;var l=u.get(t);if(l&&u.get(e))return l==e;var p=-1,h=!0,d=o&i?new At:void 0;for(u.set(t,e),u.set(e,t);++p<s;){var _=t[p],y=e[p];if(n)var v=c?n(y,_,p,e,t,u):n(_,y,p,t,e,u);if(void 0!==v){if(v)continue;h=!1;break}if(d){if(!B(e,function(t,e){if(!d.has(e)&&(_===t||r(_,t,n,o,u)))return d.add(e)})){h=!1;break}}else if(_!==y&&!r(_,y,n,o,u)){h=!1;break}}return u.delete(t),u.delete(e),h}function zt(t,e){var r,n,o=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof e?"string":"hash"]:o.map}function Wt(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return Lt(r)?r:void 0}var Qt=function(t){return rt.call(t)};function Gt(t,e){return!!(e=null==e?c:e)&&("number"==typeof t||P.test(t))&&t>-1&&t%1==0&&t<e}function qt(t,e){if(re(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!ce(t))||(A.test(t)||!S.test(t)||null!=e&&t in Object(e))}function Yt(t){return t==t&&!ae(t)}function Ht(t,e){return function(r){return null!=r&&(r[t]===e&&(void 0!==e||t in Object(r)))}}(st&&Qt(new st(new ArrayBuffer(1)))!=E||ft&&Qt(new ft)!=y||lt&&"[object Promise]"!=Qt(lt.resolve())||pt&&Qt(new pt)!=m||ht&&"[object WeakMap]"!=Qt(new ht))&&(Qt=function(t){var e=rt.call(t),r=e==b?t.constructor:void 0,n=r?Xt(r):void 0;if(n)switch(n){case _t:return E;case yt:return y;case vt:return"[object Promise]";case bt:return m;case gt:return"[object WeakMap]"}return e});var Kt=Zt(function(t){var e;t=null==(e=t)?"":function(t){if("string"==typeof t)return t;if(ce(t))return wt?wt.call(t):"";var e=t+"";return"0"==e&&1/t==-u?"-0":e}(e);var r=[];return k.test(t)&&r.push(""),t.replace(T,function(t,e,n,o){r.push(n?o.replace(C,"$1"):e||t)}),r});function Jt(t){if("string"==typeof t||ce(t))return t;var e=t+"";return"0"==e&&1/t==-u?"-0":e}function Xt(t){if(null!=t){try{return tt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Zt(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new TypeError(n);var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=t.apply(this,n);return r.cache=i.set(o,a),a};return r.cache=new(Zt.Cache||St),r}function te(t,e){return t===e||t!=t&&e!=e}function ee(t){return function(t){return ue(t)&&ne(t)}(t)&&et.call(t,"callee")&&(!at.call(t,"callee")||rt.call(t)==s)}Zt.Cache=St;var re=Array.isArray;function ne(t){return null!=t&&ie(t.length)&&!oe(t)}function oe(t){var e=ae(t)?rt.call(t):"";return e==d||e==_}function ie(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=c}function ae(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function ue(t){return!!t&&"object"==typeof t}function ce(t){return"symbol"==typeof t||ue(t)&&rt.call(t)==w}var se=U?function(t){return function(e){return t(e)}}(U):function(t){return ue(t)&&ie(t.length)&&!!$[rt.call(t)]};function fe(t){return ne(t)?Tt(t):Ut(t)}function le(t){return t}t.exports=function(t,e,r){var n=re(t)?V:Dt;return r&&function(t,e,r){if(!ae(r))return!1;var n=typeof e;return!!("number"==n?ne(r)&&Gt(e,r.length):"string"==n&&e in r)&&te(r[e],t)}(t,e,r)&&(e=void 0),n(t,Nt(e))}}).call(this,r(0)(t))},function(t,e){var r="Expected a function",n="__lodash_hash_undefined__",o=1/0,i=9007199254740991,a="[object Arguments]",u="[object Function]",c="[object GeneratorFunction]",s="[object Symbol]",f=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,l=/^\w*$/,p=/^\./,h=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,d=/\\(\\)?/g,_=/^\[object .+?Constructor\]$/,y=/^(?:0|[1-9]\d*)$/,v="object"==typeof global&&global&&global.Object===Object&&global,b="object"==typeof self&&self&&self.Object===Object&&self,g=v||b||Function("return this")();var m,j=Array.prototype,w=Function.prototype,O=Object.prototype,E=g["__core-js_shared__"],S=(m=/[^.]+$/.exec(E&&E.keys&&E.keys.IE_PROTO||""))?"Symbol(src)_1."+m:"",A=w.toString,k=O.hasOwnProperty,T=O.toString,C=RegExp("^"+A.call(k).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),R=g.Symbol,P=O.propertyIsEnumerable,$=j.splice,D=W(g,"Map"),x=W(Object,"create"),I=R?R.prototype:void 0,F=I?I.toString:void 0;function M(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function L(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function N(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function U(t,e){for(var r,n,o=t.length;o--;)if((r=t[o][0])===(n=e)||r!=r&&n!=n)return o;return-1}function V(t,e){return null!=t&&k.call(t,e)}function B(t){return!(!X(t)||S&&S in t)&&(K(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?C:_).test(function(t){if(null!=t){try{return A.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t))}function z(t,e){var r,n,o=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof e?"string":"hash"]:o.map}function W(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return B(r)?r:void 0}function Q(t,e,r){for(var n,o,u=-1,c=(e=function(t,e){if(H(t))return!1;var r=typeof t;if("number"==r||"symbol"==r||"boolean"==r||null==t||tt(t))return!0;return l.test(t)||!f.test(t)||null!=e&&t in Object(e)}(e,t)?[e]:H(n=e)?n:G(n)).length;++u<c;){var s=q(e[u]);if(!(o=null!=t&&r(t,s)))break;t=t[s]}return o||!!(c=t?t.length:0)&&J(c)&&function(t,e){return!!(e=null==e?i:e)&&("number"==typeof t||y.test(t))&&t>-1&&t%1==0&&t<e}(s,c)&&(H(t)||function(t){return function(t){return Z(t)&&function(t){return null!=t&&J(t.length)&&!K(t)}(t)}(t)&&k.call(t,"callee")&&(!P.call(t,"callee")||T.call(t)==a)}(t))}M.prototype.clear=function(){this.__data__=x?x(null):{}},M.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},M.prototype.get=function(t){var e=this.__data__;if(x){var r=e[t];return r===n?void 0:r}return k.call(e,t)?e[t]:void 0},M.prototype.has=function(t){var e=this.__data__;return x?void 0!==e[t]:k.call(e,t)},M.prototype.set=function(t,e){return this.__data__[t]=x&&void 0===e?n:e,this},L.prototype.clear=function(){this.__data__=[]},L.prototype.delete=function(t){var e=this.__data__,r=U(e,t);return!(r<0||(r==e.length-1?e.pop():$.call(e,r,1),0))},L.prototype.get=function(t){var e=this.__data__,r=U(e,t);return r<0?void 0:e[r][1]},L.prototype.has=function(t){return U(this.__data__,t)>-1},L.prototype.set=function(t,e){var r=this.__data__,n=U(r,t);return n<0?r.push([t,e]):r[n][1]=e,this},N.prototype.clear=function(){this.__data__={hash:new M,map:new(D||L),string:new M}},N.prototype.delete=function(t){return z(this,t).delete(t)},N.prototype.get=function(t){return z(this,t).get(t)},N.prototype.has=function(t){return z(this,t).has(t)},N.prototype.set=function(t,e){return z(this,t).set(t,e),this};var G=Y(function(t){var e;t=null==(e=t)?"":function(t){if("string"==typeof t)return t;if(tt(t))return F?F.call(t):"";var e=t+"";return"0"==e&&1/t==-o?"-0":e}(e);var r=[];return p.test(t)&&r.push(""),t.replace(h,function(t,e,n,o){r.push(n?o.replace(d,"$1"):e||t)}),r});function q(t){if("string"==typeof t||tt(t))return t;var e=t+"";return"0"==e&&1/t==-o?"-0":e}function Y(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new TypeError(r);var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var a=t.apply(this,r);return n.cache=i.set(o,a),a};return n.cache=new(Y.Cache||N),n}Y.Cache=N;var H=Array.isArray;function K(t){var e=X(t)?T.call(t):"";return e==u||e==c}function J(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=i}function X(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function Z(t){return!!t&&"object"==typeof t}function tt(t){return"symbol"==typeof t||Z(t)&&T.call(t)==s}t.exports=function(t,e){return null!=t&&Q(t,e,V)}},function(t,e){t.exports=function(t){return t?t[0]:void 0}},function(t,e){var r,n=9007199254740991,o="[object Function]",i="[object GeneratorFunction]",a="[object Map]",u="[object Set]",c="[object String]",s=/^\[object .+?Constructor\]$/,f="[\\ud800-\\udfff]",l="[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]",p="\\ud83c[\\udffb-\\udfff]",h="[^\\ud800-\\udfff]",d="(?:\\ud83c[\\udde6-\\uddff]){2}",_="[\\ud800-\\udbff][\\udc00-\\udfff]",y="(?:"+l+"|"+p+")"+"?",v="[\\ufe0e\\ufe0f]?"+y+("(?:\\u200d(?:"+[h,d,_].join("|")+")[\\ufe0e\\ufe0f]?"+y+")*"),b="(?:"+[h+l+"?",l,d,_,f].join("|")+")",g=RegExp(p+"(?="+p+")|"+b+v,"g"),m=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0\\ufe0e\\ufe0f]"),j="object"==typeof global&&global&&global.Object===Object&&global,w="object"==typeof self&&self&&self.Object===Object&&self,O=j||w||Function("return this")(),E=(r="length",function(t){return null==t?void 0:t[r]});function S(t){return function(t){return m.test(t)}(t)?function(t){var e=g.lastIndex=0;for(;g.test(t);)e++;return e}(t):E(t)}var A,k,T,C=Function.prototype,R=Object.prototype,P=O["__core-js_shared__"],$=(A=/[^.]+$/.exec(P&&P.keys&&P.keys.IE_PROTO||""))?"Symbol(src)_1."+A:"",D=C.toString,x=R.hasOwnProperty,I=R.toString,F=RegExp("^"+D.call(x).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),M=(k=Object.keys,T=Object,function(t){return k(T(t))}),L=K(O,"DataView"),N=K(O,"Map"),U=K(O,"Promise"),V=K(O,"Set"),B=K(O,"WeakMap"),z=X(L),W=X(N),Q=X(U),G=X(V),q=X(B);function Y(t){return!(!et(t)||$&&$ in t)&&(tt(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?F:s).test(X(t))}function H(t){if(r=(e=t)&&e.constructor,n="function"==typeof r&&r.prototype||R,e!==n)return M(t);var e,r,n,o=[];for(var i in Object(t))x.call(t,i)&&"constructor"!=i&&o.push(i);return o}function K(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return Y(r)?r:void 0}var J=function(t){return I.call(t)};function X(t){if(null!=t){try{return D.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(L&&"[object DataView]"!=J(new L(new ArrayBuffer(1)))||N&&J(new N)!=a||U&&"[object Promise]"!=J(U.resolve())||V&&J(new V)!=u||B&&"[object WeakMap]"!=J(new B))&&(J=function(t){var e=I.call(t),r="[object Object]"==e?t.constructor:void 0,n=r?X(r):void 0;if(n)switch(n){case z:return"[object DataView]";case W:return a;case Q:return"[object Promise]";case G:return u;case q:return"[object WeakMap]"}return e});var Z=Array.isArray;function tt(t){var e=et(t)?I.call(t):"";return e==o||e==i}function et(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}t.exports=function(t){if(null==t)return 0;if(null!=(e=t)&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=n}(e.length)&&!tt(e))return function(t){return"string"==typeof t||!Z(t)&&function(t){return!!t&&"object"==typeof t}(t)&&I.call(t)==c}(t)?S(t):t.length;var e,r=J(t);return r==a||r==u?t.size:H(t).length}},function(t,e){var r=Array.isArray;t.exports=r},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(4),o=r(5),i=r(11),a=r(30),u=r(29),c=r(19),s=r(9),f=r(16),l=r(28),p=r(17),h=r(8),d=r(3),_=r(27),y=r(26),v=r(7),b=r(25),g=r(1),m=r(24),j=r(2),w=r(15);function O(t){if(o(t))return"'select' clause couldn't be empty"}function E(t){return i(t)&&!a(t)}function S(t){return b(t)||E(t)&&1===u(t)&&j.AVAILABLE_ORDER_BY_CLAUSE_VALUES.has(l(c(t)))}function A(t){return d(t,"joinID",!1)?`join.${t.joinID}.`:""}function k(t,e){if(!a(e)&&!o(e))return`'select.value' clause for '${t}' queries should be array of strings or empty`}function T(t,e,r){if(!i(t)||!a(e))return"'select' clause must have next structure: { key: [...], value: [...] }"}function C(t,e){if(!a(e)||1!==u(e))return`'select.key' clause for '${t}' queries must have only 1 item`}e.validateQueryStructure=function(t,e={}){return new Promise((r,c)=>{const l=[...function(t,e){const r=[],n=d(t,"dataset"),i=d(t,"branch"),a=d(t,"commit");return o(n)||b(n)||r.push("'dataset' clause must be string only"),o(i)||b(i)||r.push("'branch' clause must be string only"),o(a)||b(a)||r.push("'commit' clause must be string only"),r}(t),...function(t,e){const r=[],n=d(t,"from",null);if(o(n)&&r.push("'from' clause couldn't be empty"),b(n)||r.push("'from' clause must be string only"),!j.AVAILABLE_FROM_CLAUSE_VALUES.has(n)){const t=[...j.AVAILABLE_FROM_CLAUSE_VALUES];r.push(`'from' clause must be one of the list: ${t.join(", ")}`)}return r}(t),...function(t,e){const r=[],n=d(t,"select",null),o=d(t,"from",null),c=d(n,"key"),s=d(n,"value");switch(!0){case j.isSchemaQuery(t):r.push(O(n),function(t,e){if(!a(e)||2!==u(e))return`'select.key' clause for '${t}' queries must have exactly 2 items: 'key', 'value'`}(o,c),k(o,s));break;case j.isEntitiesQuery(t):case j.isConceptsQuery(t):r.push(O(n),T(n,c,s),C(o,c),k(o,s));break;case j.isDatapointsQuery(t):r.push(O(n),function(t,e,r){if(!i(t)||!a(e)||!a(r))return"'select' clause must have next structure: { key: [...], value: [...] }"}(n,c,s),function(t,e){if(u(e)<2)return`'select.key' clause for '${t}' queries must have at least 2 items`}(o,c),function(t,e){const r=p(e,(t,e,r)=>g(r,t,e+1));if(u(r)>0)return`'select.key' clause for '${t}' queries contains duplicates: ${m(r).join(",")}`}(o,c),function(t,e){if(u(e)<1)return`'select.value' clause for '${t}' queries must have at least 1 item`}(o,s));break;default:r.push(O(n))}return v(r)}(t),...function(t,e){const r=[],i=d(t,"join",null),a=d(t,"where",null),u=function t(e){const r=[];for(const n in e)h(n,"$")&&r.push({name:n,isLeaf:!1}),w.isPrimitive(e[n])?h(e[n],"$")&&r.push({name:e[n],isLeaf:!0}):r.push(...t(e[n]));return r}(a);return r.push(function(t,e){if(!o(t)&&!E(t))return`'${e}where' clause must be object only`}(a,A(e)),function(t,e,r){const o=p(e,e=>!function(t,e){return function(t){return!t.isLeaf&&j.AVAILABLE_QUERY_OPERATORS.has(t.name)}(e)||function(t,e){return e.isLeaf&&h(e.name,"$")&&_(t,e.name)}(t,e)}(t,e)).map(t=>t.name),i=[...j.AVAILABLE_QUERY_OPERATORS.values(),...s(t)];if(!n(o))return`'${r}where' clause has unknown operator(s) '${o.join(", ")}', replace it with allowed operators: ${i.join(", ")}`}(i,u,A(e))),v(r)}(t,e),...function(t,e){const r=[],n=d(t,"language",null);switch(!0){case j.isSchemaQuery(t):r.push(function(t){if(_(t,"language"))return"'language' clause for '*.schema' queries shouldn't be present in query"}(t));break;case j.isEntitiesQuery(t):case j.isConceptsQuery(t):case j.isDatapointsQuery(t):default:r.push(function(t){if(!o(t)&&!b(t))return"'language' clause must be string only"}(n))}return v(r)}(t),...function(t,e){const r=[],n=d(t,"join",null);switch(!0){case j.isSchemaQuery(t):case j.isConceptsQuery(t):r.push(function(t){if(_(t,"join"))return`'join' clause for '${t.from}' queries shouldn't be present in query`}(t));break;case j.isEntitiesQuery(t):case j.isDatapointsQuery(t):default:r.push(function(t){if(!o(t)&&!E(t))return"'join' clause must be object only"}(n),...f(n,(t,e)=>(function(t,e){if(!o(t.key)&&!b(t.key))return`'${e}key' clause must be string only`})(t,A({joinID:e}))))}return v(r)}(t),...function(t,e){const r=[],n=d(t,"order_by",null);return r.push(function(t){if(!(o(t)||b(t)||(e=t,a(e)&&y(e,b))||function(t,e){return a(t)&&y(t,e)}(t,S)))return"'order_by' clause must be string or array of strings || objects only";var e}(n)),v(r)}(t)];return n(l)?r():c(`Too many query structure errors: \n* ${l.join("\n* ")}`)})}},function(t,e,r){(function(t){var r=200,n="Expected a function",o="__lodash_hash_undefined__",i=1,a=2,u=1/0,c=9007199254740991,s="[object Arguments]",f="[object Array]",l="[object Boolean]",p="[object Date]",h="[object Error]",d="[object Function]",_="[object GeneratorFunction]",y="[object Map]",v="[object Number]",b="[object Object]",g="[object RegExp]",m="[object Set]",j="[object String]",w="[object Symbol]",O="[object ArrayBuffer]",E="[object DataView]",S=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,A=/^\w*$/,k=/^\./,T=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,C=/\\(\\)?/g,R=/^\[object .+?Constructor\]$/,P=/^(?:0|[1-9]\d*)$/,$={};$["[object Float32Array]"]=$["[object Float64Array]"]=$["[object Int8Array]"]=$["[object Int16Array]"]=$["[object Int32Array]"]=$["[object Uint8Array]"]=$["[object Uint8ClampedArray]"]=$["[object Uint16Array]"]=$["[object Uint32Array]"]=!0,$[s]=$[f]=$[O]=$[l]=$[E]=$[p]=$[h]=$[d]=$[y]=$[v]=$[b]=$[g]=$[m]=$[j]=$["[object WeakMap]"]=!1;var D="object"==typeof global&&global&&global.Object===Object&&global,x="object"==typeof self&&self&&self.Object===Object&&self,I=D||x||Function("return this")(),F="object"==typeof e&&e&&!e.nodeType&&e,M=F&&"object"==typeof t&&t&&!t.nodeType&&t,L=M&&M.exports===F&&D.process,N=function(){try{return L&&L.binding("util")}catch(t){}}(),U=N&&N.isTypedArray;function V(t,e){for(var r=-1,n=t?t.length:0,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}function B(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}function z(t,e){for(var r=-1,n=t?t.length:0;++r<n;)if(e(t[r],r,t))return!0;return!1}function W(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}function Q(t){var e=-1,r=Array(t.size);return t.forEach(function(t,n){r[++e]=[n,t]}),r}function G(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r}var q,Y,H,K=Array.prototype,J=Function.prototype,X=Object.prototype,Z=I["__core-js_shared__"],tt=(q=/[^.]+$/.exec(Z&&Z.keys&&Z.keys.IE_PROTO||""))?"Symbol(src)_1."+q:"",et=J.toString,rt=X.hasOwnProperty,nt=X.toString,ot=RegExp("^"+et.call(rt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),it=I.Symbol,at=I.Uint8Array,ut=X.propertyIsEnumerable,ct=K.splice,st=it?it.isConcatSpreadable:void 0,ft=(Y=Object.keys,H=Object,function(t){return Y(H(t))}),lt=Gt(I,"DataView"),pt=Gt(I,"Map"),ht=Gt(I,"Promise"),dt=Gt(I,"Set"),_t=Gt(I,"WeakMap"),yt=Gt(Object,"create"),vt=ee(lt),bt=ee(pt),gt=ee(ht),mt=ee(dt),jt=ee(_t),wt=it?it.prototype:void 0,Ot=wt?wt.valueOf:void 0,Et=wt?wt.toString:void 0;function St(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function At(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function kt(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function Tt(t){var e=-1,r=t?t.length:0;for(this.__data__=new kt;++e<r;)this.add(t[e])}function Ct(t){this.__data__=new At(t)}function Rt(t,e){var r=ie(t)||oe(t)?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],n=r.length,o=!!n;for(var i in t)!e&&!rt.call(t,i)||o&&("length"==i||Ht(i,n))||r.push(i);return r}function Pt(t,e){for(var r=t.length;r--;)if(ne(t[r][0],e))return r;return-1}St.prototype.clear=function(){this.__data__=yt?yt(null):{}},St.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},St.prototype.get=function(t){var e=this.__data__;if(yt){var r=e[t];return r===o?void 0:r}return rt.call(e,t)?e[t]:void 0},St.prototype.has=function(t){var e=this.__data__;return yt?void 0!==e[t]:rt.call(e,t)},St.prototype.set=function(t,e){return this.__data__[t]=yt&&void 0===e?o:e,this},At.prototype.clear=function(){this.__data__=[]},At.prototype.delete=function(t){var e=this.__data__,r=Pt(e,t);return!(r<0||(r==e.length-1?e.pop():ct.call(e,r,1),0))},At.prototype.get=function(t){var e=this.__data__,r=Pt(e,t);return r<0?void 0:e[r][1]},At.prototype.has=function(t){return Pt(this.__data__,t)>-1},At.prototype.set=function(t,e){var r=this.__data__,n=Pt(r,t);return n<0?r.push([t,e]):r[n][1]=e,this},kt.prototype.clear=function(){this.__data__={hash:new St,map:new(pt||At),string:new St}},kt.prototype.delete=function(t){return Qt(this,t).delete(t)},kt.prototype.get=function(t){return Qt(this,t).get(t)},kt.prototype.has=function(t){return Qt(this,t).has(t)},kt.prototype.set=function(t,e){return Qt(this,t).set(t,e),this},Tt.prototype.add=Tt.prototype.push=function(t){return this.__data__.set(t,o),this},Tt.prototype.has=function(t){return this.__data__.has(t)},Ct.prototype.clear=function(){this.__data__=new At},Ct.prototype.delete=function(t){return this.__data__.delete(t)},Ct.prototype.get=function(t){return this.__data__.get(t)},Ct.prototype.has=function(t){return this.__data__.has(t)},Ct.prototype.set=function(t,e){var n=this.__data__;if(n instanceof At){var o=n.__data__;if(!pt||o.length<r-1)return o.push([t,e]),this;n=this.__data__=new kt(o)}return n.set(t,e),this};var $t,Dt,xt=($t=function(t,e){return t&&It(t,e,he)},function(t,e){if(null==t)return t;if(!ae(t))return $t(t,e);for(var r=t.length,n=Dt?r:-1,o=Object(t);(Dt?n--:++n<r)&&!1!==e(o[n],n,o););return t});var It=function(t){return function(e,r,n){for(var o=-1,i=Object(e),a=n(e),u=a.length;u--;){var c=a[t?u:++o];if(!1===r(i[c],c,i))break}return e}}();function Ft(t,e){for(var r=0,n=(e=Kt(e,t)?[e]:zt(e)).length;null!=t&&r<n;)t=t[te(e[r++])];return r&&r==n?t:void 0}function Mt(t,e){return null!=t&&e in Object(t)}function Lt(t,e,r,n,o){return t===e||(null==t||null==e||!se(t)&&!fe(e)?t!=t&&e!=e:function(t,e,r,n,o,u){var c=ie(t),d=ie(e),_=f,S=f;c||(_=(_=qt(t))==s?b:_);d||(S=(S=qt(e))==s?b:S);var A=_==b&&!W(t),k=S==b&&!W(e),T=_==S;if(T&&!A)return u||(u=new Ct),c||pe(t)?Wt(t,e,r,n,o,u):function(t,e,r,n,o,u,c){switch(r){case E:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case O:return!(t.byteLength!=e.byteLength||!n(new at(t),new at(e)));case l:case p:case v:return ne(+t,+e);case h:return t.name==e.name&&t.message==e.message;case g:case j:return t==e+"";case y:var s=Q;case m:var f=u&a;if(s||(s=G),t.size!=e.size&&!f)return!1;var d=c.get(t);if(d)return d==e;u|=i,c.set(t,e);var _=Wt(s(t),s(e),n,o,u,c);return c.delete(t),_;case w:if(Ot)return Ot.call(t)==Ot.call(e)}return!1}(t,e,_,r,n,o,u);if(!(o&a)){var C=A&&rt.call(t,"__wrapped__"),R=k&&rt.call(e,"__wrapped__");if(C||R){var P=C?t.value():t,$=R?e.value():e;return u||(u=new Ct),r(P,$,n,o,u)}}if(!T)return!1;return u||(u=new Ct),function(t,e,r,n,o,i){var u=o&a,c=he(t),s=c.length,f=he(e).length;if(s!=f&&!u)return!1;for(var l=s;l--;){var p=c[l];if(!(u?p in e:rt.call(e,p)))return!1}var h=i.get(t);if(h&&i.get(e))return h==e;var d=!0;i.set(t,e),i.set(e,t);for(var _=u;++l<s;){p=c[l];var y=t[p],v=e[p];if(n)var b=u?n(v,y,p,e,t,i):n(y,v,p,t,e,i);if(!(void 0===b?y===v||r(y,v,n,o,i):b)){d=!1;break}_||(_="constructor"==p)}if(d&&!_){var g=t.constructor,m=e.constructor;g!=m&&"constructor"in t&&"constructor"in e&&!("function"==typeof g&&g instanceof g&&"function"==typeof m&&m instanceof m)&&(d=!1)}return i.delete(t),i.delete(e),d}(t,e,r,n,o,u)}(t,e,Lt,r,n,o))}function Nt(t){return!(!se(t)||tt&&tt in t)&&(ue(t)||W(t)?ot:R).test(ee(t))}function Ut(t){return"function"==typeof t?t:null==t?de:"object"==typeof t?ie(t)?function(t,e){if(Kt(t)&&Jt(e))return Xt(te(t),e);return function(r){var n=function(t,e,r){var n=null==t?void 0:Ft(t,e);return void 0===n?r:n}(r,t);return void 0===n&&n===e?function(t,e){return null!=t&&function(t,e,r){var n,o=-1,i=(e=Kt(e,t)?[e]:zt(e)).length;for(;++o<i;){var a=te(e[o]);if(!(n=null!=t&&r(t,a)))break;t=t[a]}if(n)return n;return!!(i=t?t.length:0)&&ce(i)&&Ht(a,i)&&(ie(t)||oe(t))}(t,e,Mt)}(r,t):Lt(e,n,void 0,i|a)}}(t[0],t[1]):function(t){var e=function(t){var e=he(t),r=e.length;for(;r--;){var n=e[r],o=t[n];e[r]=[n,o,Jt(o)]}return e}(t);if(1==e.length&&e[0][2])return Xt(e[0][0],e[0][1]);return function(r){return r===t||function(t,e,r,n){var o=r.length,u=o,c=!n;if(null==t)return!u;for(t=Object(t);o--;){var s=r[o];if(c&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++o<u;){var f=(s=r[o])[0],l=t[f],p=s[1];if(c&&s[2]){if(void 0===l&&!(f in t))return!1}else{var h=new Ct;if(n)var d=n(l,p,f,t,e,h);if(!(void 0===d?Lt(p,l,n,i|a,h):d))return!1}}return!0}(r,t,e)}}(t):Kt(e=t)?(r=te(e),function(t){return null==t?void 0:t[r]}):function(t){return function(e){return Ft(e,t)}}(e);var e,r}function Vt(t){if(r=(e=t)&&e.constructor,n="function"==typeof r&&r.prototype||X,e!==n)return ft(t);var e,r,n,o=[];for(var i in Object(t))rt.call(t,i)&&"constructor"!=i&&o.push(i);return o}function Bt(t,e){var r=-1,n=ae(t)?Array(t.length):[];return xt(t,function(t,o,i){n[++r]=e(t,o,i)}),n}function zt(t){return ie(t)?t:Zt(t)}function Wt(t,e,r,n,o,u){var c=o&a,s=t.length,f=e.length;if(s!=f&&!(c&&f>s))return!1;var l=u.get(t);if(l&&u.get(e))return l==e;var p=-1,h=!0,d=o&i?new Tt:void 0;for(u.set(t,e),u.set(e,t);++p<s;){var _=t[p],y=e[p];if(n)var v=c?n(y,_,p,e,t,u):n(_,y,p,t,e,u);if(void 0!==v){if(v)continue;h=!1;break}if(d){if(!z(e,function(t,e){if(!d.has(e)&&(_===t||r(_,t,n,o,u)))return d.add(e)})){h=!1;break}}else if(_!==y&&!r(_,y,n,o,u)){h=!1;break}}return u.delete(t),u.delete(e),h}function Qt(t,e){var r,n,o=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof e?"string":"hash"]:o.map}function Gt(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return Nt(r)?r:void 0}var qt=function(t){return nt.call(t)};function Yt(t){return ie(t)||oe(t)||!!(st&&t&&t[st])}function Ht(t,e){return!!(e=null==e?c:e)&&("number"==typeof t||P.test(t))&&t>-1&&t%1==0&&t<e}function Kt(t,e){if(ie(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!le(t))||(A.test(t)||!S.test(t)||null!=e&&t in Object(e))}function Jt(t){return t==t&&!se(t)}function Xt(t,e){return function(r){return null!=r&&(r[t]===e&&(void 0!==e||t in Object(r)))}}(lt&&qt(new lt(new ArrayBuffer(1)))!=E||pt&&qt(new pt)!=y||ht&&"[object Promise]"!=qt(ht.resolve())||dt&&qt(new dt)!=m||_t&&"[object WeakMap]"!=qt(new _t))&&(qt=function(t){var e=nt.call(t),r=e==b?t.constructor:void 0,n=r?ee(r):void 0;if(n)switch(n){case vt:return E;case bt:return y;case gt:return"[object Promise]";case mt:return m;case jt:return"[object WeakMap]"}return e});var Zt=re(function(t){var e;t=null==(e=t)?"":function(t){if("string"==typeof t)return t;if(le(t))return Et?Et.call(t):"";var e=t+"";return"0"==e&&1/t==-u?"-0":e}(e);var r=[];return k.test(t)&&r.push(""),t.replace(T,function(t,e,n,o){r.push(n?o.replace(C,"$1"):e||t)}),r});function te(t){if("string"==typeof t||le(t))return t;var e=t+"";return"0"==e&&1/t==-u?"-0":e}function ee(t){if(null!=t){try{return et.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function re(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new TypeError(n);var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=t.apply(this,n);return r.cache=i.set(o,a),a};return r.cache=new(re.Cache||kt),r}function ne(t,e){return t===e||t!=t&&e!=e}function oe(t){return function(t){return fe(t)&&ae(t)}(t)&&rt.call(t,"callee")&&(!ut.call(t,"callee")||nt.call(t)==s)}re.Cache=kt;var ie=Array.isArray;function ae(t){return null!=t&&ce(t.length)&&!ue(t)}function ue(t){var e=se(t)?nt.call(t):"";return e==d||e==_}function ce(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=c}function se(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function fe(t){return!!t&&"object"==typeof t}function le(t){return"symbol"==typeof t||fe(t)&&nt.call(t)==w}var pe=U?function(t){return function(e){return t(e)}}(U):function(t){return fe(t)&&ce(t.length)&&!!$[nt.call(t)]};function he(t){return ae(t)?Rt(t):Vt(t)}function de(t){return t}t.exports=function(t,e){return function t(e,r,n,o,i){var a=-1,u=e.length;for(n||(n=Yt),i||(i=[]);++a<u;){var c=e[a];r>0&&n(c)?r>1?t(c,r-1,n,o,i):B(i,c):o||(i[i.length]=c)}return i}(function(t,e){return(ie(t)?V:Bt)(t,Ut(e))}(t,e),1)}}).call(this,r(0)(t))},function(t,e){var r=1/0,n="[object Symbol]",o=/^\s+/,i="[\\ud800-\\udfff]",a="[\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0]",u="\\ud83c[\\udffb-\\udfff]",c="[^\\ud800-\\udfff]",s="(?:\\ud83c[\\udde6-\\uddff]){2}",f="[\\ud800-\\udbff][\\udc00-\\udfff]",l="(?:"+a+"|"+u+")"+"?",p="[\\ufe0e\\ufe0f]?"+l+("(?:\\u200d(?:"+[c,s,f].join("|")+")[\\ufe0e\\ufe0f]?"+l+")*"),h="(?:"+[c+a+"?",a,s,f,i].join("|")+")",d=RegExp(u+"(?="+u+")|"+h+p,"g"),_=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe23\\u20d0-\\u20f0\\ufe0e\\ufe0f]"),y="object"==typeof global&&global&&global.Object===Object&&global,v="object"==typeof self&&self&&self.Object===Object&&self,b=y||v||Function("return this")();function g(t,e,r){if(e!=e)return function(t,e,r,n){for(var o=t.length,i=r+(n?1:-1);n?i--:++i<o;)if(e(t[i],i,t))return i;return-1}(t,m,r);for(var n=r-1,o=t.length;++n<o;)if(t[n]===e)return n;return-1}function m(t){return t!=t}function j(t){return function(t){return _.test(t)}(t)?function(t){return t.match(d)||[]}(t):function(t){return t.split("")}(t)}var w=Object.prototype.toString,O=b.Symbol,E=O?O.prototype:void 0,S=E?E.toString:void 0;function A(t){if("string"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&w.call(t)==n}(t))return S?S.call(t):"";var e=t+"";return"0"==e&&1/t==-r?"-0":e}function k(t,e,r){var n=t.length;return r=void 0===r?n:r,!e&&r>=n?t:function(t,e,r){var n=-1,o=t.length;e<0&&(e=-e>o?0:o+e),(r=r>o?o:r)<0&&(r+=o),o=e>r?0:r-e>>>0,e>>>=0;for(var i=Array(o);++n<o;)i[n]=t[n+e];return i}(t,e,r)}t.exports=function(t,e,r){var n;if((t=null==(n=t)?"":A(n))&&(r||void 0===e))return t.replace(o,"");if(!t||!(e=A(e)))return t;var i=j(t);return k(i,function(t,e){for(var r=-1,n=t.length;++r<n&&g(e,t[r],0)>-1;);return r}(i,j(e))).join("")}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(4),o=r(17),i=r(16),a=r(3),u=r(7),c=r(1),s=r(8),f=r(5),l=r(33),p=(r(32),r(2)),h=r(15);function d(t,e){return o(t,t=>!c(e,t))}function _(t,e){const r=o([...e.values()],({concept_type:e})=>c(t,e));return i(r,"concept")}e.validateQueryDefinitions=function(t,e={}){return new Promise((r,o)=>{const i=[...function(t,e){const r=[],o=a(t,"from",null),i=a(t,"select",null),c=a(i,"key"),s=a(i,"value"),f=[],l=[],{conceptsLookup:h}=e;switch(!0){case p.isDatapointsQuery(t):const e=[p.CONCEPT_TYPE_ENTITY_SET,p.CONCEPT_TYPE_ENTITY_DOMAIN,p.CONCEPT_TYPE_TIME];f.push(..._(e,h)),l.push(...h.keys());break;case p.isEntitiesQuery(t):const r=[p.CONCEPT_TYPE_ENTITY_SET,p.CONCEPT_TYPE_ENTITY_DOMAIN];f.push(..._(r,h)),l.push(...h.keys());break;case p.isConceptsQuery(t):f.push(p.RESERVED_CONCEPT),l.push(...h.keys(),p.RESERVED_CONCEPT,p.RESERVED_CONCEPT_TYPE,p.RESERVED_DOMAIN,p.RESERVED_UNIT,p.RESERVED_DRILL_UP);break;default:f.push(p.RESERVED_KEY,p.RESERVED_VALUE),l.push(p.RESERVED_KEY,p.RESERVED_VALUE)}return r.push(function(t,e,r){const o=d(e,r);if(!n(o))return`'select.key' clause for '${t}' query contains unavailable item(s): ${o.join(", ")}`}(o,c,f),function(t,e,r){const o=d(e,r);if(!n(e)&&!n(o))return`'select.value' clause for '${t}' query contains unavailable item(s): ${o.join(", ")}`}(o,s,l)),u(r)}(t,e),...function(t,e){const r=[],o=a(t,"where",null),i=(a(t,"from",null),a(t,"select",null)),{conceptsLookup:c}=e;switch(a(i,"key"),a(i,"value"),function(t){const e={};!function t(e,r,o){for(const i in e){const a=!f(o),u=!a&&!s(i,"$")&&isNaN(+i),[c,...p]=i.split(".");u&&(f(r[c])&&(r[l(c,"is--")]=[]),n(p)||r[c].push(l(p.join("."),"is--"))),h.isPrimitive(e[i])||t(e[i],r,u?c:o)}}(t,e)}(o),!0){case p.isDatapointsQuery(t):const e=[];e.push(p.CONCEPT_TYPE_ENTITY_SET,p.CONCEPT_TYPE_ENTITY_DOMAIN,p.CONCEPT_TYPE_TIME),r.push()}return u(r)}(t,e)];return n(i)?r():o(`Too many query definition errors [repo: ${t.dataset}]: \n* ${i.join("\n* ")}`)})}},function(t,e){var r=1/0,n=9007199254740991,o="[object Arguments]",i="[object Function]",a="[object GeneratorFunction]",u="object"==typeof global&&global&&global.Object===Object&&global,c="object"==typeof self&&self&&self.Object===Object&&self,s=u||c||Function("return this")();function f(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}var l=Object.prototype,p=l.hasOwnProperty,h=l.toString,d=s.Symbol,_=l.propertyIsEnumerable,y=d?d.isConcatSpreadable:void 0;function v(t){return b(t)||function(t){return function(t){return function(t){return!!t&&"object"==typeof t}(t)&&function(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=n}(t.length)&&!function(t){var e=function(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}(t)?h.call(t):"";return e==i||e==a}(t)}(t)}(t)&&p.call(t,"callee")&&(!_.call(t,"callee")||h.call(t)==o)}(t)||!!(y&&t&&t[y])}var b=Array.isArray;t.exports=function(t){return t&&t.length?function t(e,r,n,o,i){var a=-1,u=e.length;for(n||(n=v),i||(i=[]);++a<u;){var c=e[a];r>0&&n(c)?r>1?t(c,r-1,n,o,i):f(i,c):o||(i[i.length]=c)}return i}(t,r):[]}},function(t,e){t.exports=require("path")},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(36),o=r(10),i=r(19),a=r(9),u=r(3),c=r(35),s=r(4),f=r(8),l=r(1),p=r(7),h=r(12),d=r(6),_=r(13),y="where",v="join",b="$in",g="$and",m=t=>o(i(t)),j=t=>o(a(t)),w=t=>1===a(t).length;e.InClauseUnderConjunction=class{constructor(t,e){this.flow={},this.fileReader=e.fileReader,this.datasetPath=e.datasetPath,this.query=t,this.datapackage=e.datapackage,this.conceptsLookup=e.conceptsLookup}isMatched(){this.flow.joinObject=u(this.query,v);const t=p(d.featureDetectors.map(t=>t(this.query,this.conceptsLookup)));return l(t,d.QueryFeature.WhereClauseBasedOnConjunction)&&l(t,d.QueryFeature.ConjunctionPartFromWhereClauseCorrespondsToJoin)}async getRecommendedFilesSet(){if(this.isMatched()){let t;try{this.fillResourceToFileHash(),this.collectProcessableClauses(),this.collectEntityFilesNames();const e=await this.collectEntities();this.fillEntityValuesHash(e),this.getFilesGroupsQueryClause(),t=this.getOptimalFilesGroup()}catch(t){return[]}return t}throw new h.DdfCsvError('Plugin "InClauseUnderConjunction" is not matched!',"InClauseUnderConjunction plugin")}fillResourceToFileHash(){return this.flow.resourceToFile=u(this.datapackage,"resources",[]).reduce((t,e)=>(t.set(e.name,e.path),t),new Map),this}collectProcessableClauses(){const t=a(this.flow.joinObject);this.flow.processableClauses=[];for(const e of t){const t=u(this.flow.joinObject,`${e}.${y}`,{});this.singleAndField(t)?this.flow.processableClauses.push(...c(t[g].map(t=>this.getProcessableClauses(t)))):this.flow.processableClauses.push(...this.getProcessableClauses(t))}return this}collectEntityFilesNames(){this.flow.entityFilesNames=[],this.flow.fileNameToPrimaryKeyHash=new Map;for(const t of this.datapackage.ddfSchema.entities)for(const e of this.flow.processableClauses){const r=j(e);if(o(t.primaryKey)===r)for(const e of t.resources){const t=this.flow.resourceToFile.get(e);this.flow.entityFilesNames.push(t),this.flow.fileNameToPrimaryKeyHash.set(t,r)}}return this}collectEntities(){const t=this,e=t.flow.entityFilesNames.map(e=>new Promise((r,o)=>{t.fileReader.readText(n.resolve(t.datasetPath,e),(t,n)=>{if(t)return o(t);_.parse(n,{header:!0,skipEmptyLines:!0,complete:t=>r({file:e,result:t}),error:t=>o(t)})})}));return Promise.all(e)}fillEntityValuesHash(t){const e=t=>p(a(t).filter(e=>f(e,"is--")&&("TRUE"===t[e]||"true"===t[e])).map(t=>t.replace(/^is--/,"")));this.flow.entityValueToFileHash=new Map,this.flow.entityValueToDomainHash=new Map;for(const r of t)for(const t of r.result.data){const n=this.flow.fileNameToPrimaryKeyHash.get(r.file),o=t[n],i=[...e(t)];s(i)&&i.push(n),this.flow.entityValueToDomainHash.set(o,i),this.flow.entityValueToFileHash.set(o,r.file)}return this}getFilesGroupsQueryClause(){const t=new Map;for(const e of this.flow.processableClauses){const r={entities:new Set,datapoints:new Set,concepts:new Set},n=m(e).$in;for(const t of n){r.entities.add(this.flow.entityValueToFileHash.get(t));const e=this.flow.entityValueToDomainHash.get(t);for(const t of e)for(const e of this.datapackage.ddfSchema.datapoints)for(const n of e.resources)l(e.primaryKey,t)&&r.datapoints.add(this.flow.resourceToFile.get(n))}for(const t of this.datapackage.ddfSchema.concepts)for(const e of t.resources)r.concepts.add(this.flow.resourceToFile.get(e));t.set(e,r)}return this.flow.filesGroupsByClause=t,this}getOptimalFilesGroup(){const t=this.flow.filesGroupsByClause.keys();let e,r;for(const n of t){const t=this.flow.filesGroupsByClause.get(n).datapoints.size+this.flow.filesGroupsByClause.get(n).entities.size+this.flow.filesGroupsByClause.get(n).concepts.size;(!e||t<r)&&(e=n,r=t)}return[...Array.from(this.flow.filesGroupsByClause.get(e).concepts),...Array.from(this.flow.filesGroupsByClause.get(e).entities),...Array.from(this.flow.filesGroupsByClause.get(e).datapoints)]}getProcessableClauses(t){const e=[],r=a(t);for(const n of r)!f(n,"$")&&w(t[n])&&o(a(t[n]))===b&&e.push(t);return e}singleAndField(t){return w(t)&&!!u(t,g)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(37),o=r(10);e.getAppropriatePlugin=function(t,e){const r=[new n.InClauseUnderConjunction(t,e)];return o(r.filter(t=>t.isMatched()))}},function(t,e,r){(function(t){var r=200,n="__lodash_hash_undefined__",o=9007199254740991,i="[object Arguments]",a="[object Boolean]",u="[object Date]",c="[object Function]",s="[object GeneratorFunction]",f="[object Map]",l="[object Number]",p="[object Object]",h="[object RegExp]",d="[object Set]",_="[object String]",y="[object Symbol]",v="[object ArrayBuffer]",b="[object DataView]",g="[object Float32Array]",m="[object Float64Array]",j="[object Int8Array]",w="[object Int16Array]",O="[object Int32Array]",E="[object Uint8Array]",S="[object Uint8ClampedArray]",A="[object Uint16Array]",k="[object Uint32Array]",T=/\w*$/,C=/^\[object .+?Constructor\]$/,R=/^(?:0|[1-9]\d*)$/,P={};P[i]=P["[object Array]"]=P[v]=P[b]=P[a]=P[u]=P[g]=P[m]=P[j]=P[w]=P[O]=P[f]=P[l]=P[p]=P[h]=P[d]=P[_]=P[y]=P[E]=P[S]=P[A]=P[k]=!0,P["[object Error]"]=P[c]=P["[object WeakMap]"]=!1;var $="object"==typeof global&&global&&global.Object===Object&&global,D="object"==typeof self&&self&&self.Object===Object&&self,x=$||D||Function("return this")(),I="object"==typeof e&&e&&!e.nodeType&&e,F=I&&"object"==typeof t&&t&&!t.nodeType&&t,M=F&&F.exports===I;function L(t,e){return t.set(e[0],e[1]),t}function N(t,e){return t.add(e),t}function U(t,e,r,n){var o=-1,i=t?t.length:0;for(n&&i&&(r=t[++o]);++o<i;)r=e(r,t[o],o,t);return r}function V(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}function B(t){var e=-1,r=Array(t.size);return t.forEach(function(t,n){r[++e]=[n,t]}),r}function z(t,e){return function(r){return t(e(r))}}function W(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r}var Q,G=Array.prototype,q=Function.prototype,Y=Object.prototype,H=x["__core-js_shared__"],K=(Q=/[^.]+$/.exec(H&&H.keys&&H.keys.IE_PROTO||""))?"Symbol(src)_1."+Q:"",J=q.toString,X=Y.hasOwnProperty,Z=Y.toString,tt=RegExp("^"+J.call(X).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),et=M?x.Buffer:void 0,rt=x.Symbol,nt=x.Uint8Array,ot=z(Object.getPrototypeOf,Object),it=Object.create,at=Y.propertyIsEnumerable,ut=G.splice,ct=Object.getOwnPropertySymbols,st=et?et.isBuffer:void 0,ft=z(Object.keys,Object),lt=Ft(x,"DataView"),pt=Ft(x,"Map"),ht=Ft(x,"Promise"),dt=Ft(x,"Set"),_t=Ft(x,"WeakMap"),yt=Ft(Object,"create"),vt=Vt(lt),bt=Vt(pt),gt=Vt(ht),mt=Vt(dt),jt=Vt(_t),wt=rt?rt.prototype:void 0,Ot=wt?wt.valueOf:void 0;function Et(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function St(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function At(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function kt(t){this.__data__=new St(t)}function Tt(t,e){var r=zt(t)||function(t){return function(t){return function(t){return!!t&&"object"==typeof t}(t)&&Wt(t)}(t)&&X.call(t,"callee")&&(!at.call(t,"callee")||Z.call(t)==i)}(t)?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],n=r.length,o=!!n;for(var a in t)!e&&!X.call(t,a)||o&&("length"==a||Nt(a,n))||r.push(a);return r}function Ct(t,e,r){var n=t[e];X.call(t,e)&&Bt(n,r)&&(void 0!==r||e in t)||(t[e]=r)}function Rt(t,e){for(var r=t.length;r--;)if(Bt(t[r][0],e))return r;return-1}function Pt(t,e,r,n,o,C,R){var $;if(n&&($=C?n(t,o,C,R):n(t)),void 0!==$)return $;if(!qt(t))return t;var D=zt(t);if(D){if($=function(t){var e=t.length,r=t.constructor(e);e&&"string"==typeof t[0]&&X.call(t,"index")&&(r.index=t.index,r.input=t.input);return r}(t),!e)return function(t,e){var r=-1,n=t.length;e||(e=Array(n));for(;++r<n;)e[r]=t[r];return e}(t,$)}else{var x=Lt(t),I=x==c||x==s;if(Qt(t))return function(t,e){if(e)return t.slice();var r=new t.constructor(t.length);return t.copy(r),r}(t,e);if(x==p||x==i||I&&!C){if(V(t))return C?t:{};if($=function(t){return"function"!=typeof t.constructor||Ut(t)?{}:(e=ot(t),qt(e)?it(e):{});var e}(I?{}:t),!e)return function(t,e){return xt(t,Mt(t),e)}(t,function(t,e){return t&&xt(e,Yt(e),t)}($,t))}else{if(!P[x])return C?t:{};$=function(t,e,r,n){var o=t.constructor;switch(e){case v:return Dt(t);case a:case u:return new o(+t);case b:return function(t,e){var r=e?Dt(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}(t,n);case g:case m:case j:case w:case O:case E:case S:case A:case k:return function(t,e){var r=e?Dt(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}(t,n);case f:return function(t,e,r){return U(e?r(B(t),!0):B(t),L,new t.constructor)}(t,n,r);case l:case _:return new o(t);case h:return(s=new(c=t).constructor(c.source,T.exec(c))).lastIndex=c.lastIndex,s;case d:return function(t,e,r){return U(e?r(W(t),!0):W(t),N,new t.constructor)}(t,n,r);case y:return i=t,Ot?Object(Ot.call(i)):{}}var i;var c,s}(t,x,Pt,e)}}R||(R=new kt);var F=R.get(t);if(F)return F;if(R.set(t,$),!D)var M=r?function(t){return function(t,e,r){var n=e(t);return zt(t)?n:function(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}(n,r(t))}(t,Yt,Mt)}(t):Yt(t);return function(t,e){for(var r=-1,n=t?t.length:0;++r<n&&!1!==e(t[r],r,t););}(M||t,function(o,i){M&&(o=t[i=o]),Ct($,i,Pt(o,e,r,n,i,t,R))}),$}function $t(t){return!(!qt(t)||K&&K in t)&&(Gt(t)||V(t)?tt:C).test(Vt(t))}function Dt(t){var e=new t.constructor(t.byteLength);return new nt(e).set(new nt(t)),e}function xt(t,e,r,n){r||(r={});for(var o=-1,i=e.length;++o<i;){var a=e[o],u=n?n(r[a],t[a],a,r,t):void 0;Ct(r,a,void 0===u?t[a]:u)}return r}function It(t,e){var r,n,o=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof e?"string":"hash"]:o.map}function Ft(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return $t(r)?r:void 0}Et.prototype.clear=function(){this.__data__=yt?yt(null):{}},Et.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},Et.prototype.get=function(t){var e=this.__data__;if(yt){var r=e[t];return r===n?void 0:r}return X.call(e,t)?e[t]:void 0},Et.prototype.has=function(t){var e=this.__data__;return yt?void 0!==e[t]:X.call(e,t)},Et.prototype.set=function(t,e){return this.__data__[t]=yt&&void 0===e?n:e,this},St.prototype.clear=function(){this.__data__=[]},St.prototype.delete=function(t){var e=this.__data__,r=Rt(e,t);return!(r<0||(r==e.length-1?e.pop():ut.call(e,r,1),0))},St.prototype.get=function(t){var e=this.__data__,r=Rt(e,t);return r<0?void 0:e[r][1]},St.prototype.has=function(t){return Rt(this.__data__,t)>-1},St.prototype.set=function(t,e){var r=this.__data__,n=Rt(r,t);return n<0?r.push([t,e]):r[n][1]=e,this},At.prototype.clear=function(){this.__data__={hash:new Et,map:new(pt||St),string:new Et}},At.prototype.delete=function(t){return It(this,t).delete(t)},At.prototype.get=function(t){return It(this,t).get(t)},At.prototype.has=function(t){return It(this,t).has(t)},At.prototype.set=function(t,e){return It(this,t).set(t,e),this},kt.prototype.clear=function(){this.__data__=new St},kt.prototype.delete=function(t){return this.__data__.delete(t)},kt.prototype.get=function(t){return this.__data__.get(t)},kt.prototype.has=function(t){return this.__data__.has(t)},kt.prototype.set=function(t,e){var n=this.__data__;if(n instanceof St){var o=n.__data__;if(!pt||o.length<r-1)return o.push([t,e]),this;n=this.__data__=new At(o)}return n.set(t,e),this};var Mt=ct?z(ct,Object):function(){return[]},Lt=function(t){return Z.call(t)};function Nt(t,e){return!!(e=null==e?o:e)&&("number"==typeof t||R.test(t))&&t>-1&&t%1==0&&t<e}function Ut(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Y)}function Vt(t){if(null!=t){try{return J.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Bt(t,e){return t===e||t!=t&&e!=e}(lt&&Lt(new lt(new ArrayBuffer(1)))!=b||pt&&Lt(new pt)!=f||ht&&"[object Promise]"!=Lt(ht.resolve())||dt&&Lt(new dt)!=d||_t&&"[object WeakMap]"!=Lt(new _t))&&(Lt=function(t){var e=Z.call(t),r=e==p?t.constructor:void 0,n=r?Vt(r):void 0;if(n)switch(n){case vt:return b;case bt:return f;case gt:return"[object Promise]";case mt:return d;case jt:return"[object WeakMap]"}return e});var zt=Array.isArray;function Wt(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=o}(t.length)&&!Gt(t)}var Qt=st||function(){return!1};function Gt(t){var e=qt(t)?Z.call(t):"";return e==c||e==s}function qt(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function Yt(t){return Wt(t)?Tt(t):function(t){if(!Ut(t))return ft(t);var e=[];for(var r in Object(t))X.call(t,r)&&"constructor"!=r&&e.push(r);return e}(t)}t.exports=function(t){return Pt(t,!0,!0)}}).call(this,r(0)(t))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(1),o=r(39),i=r(4),a=r(38),u=r(12),c=r(6),s=r(13),f=t=>!("number"!=typeof t&&!t);e.ddfCsvReader=function(t){const e=[{concept:"concept",concept_type:"string",domain:null},{concept:"concept_type",concept_type:"string",domain:null}],r=new Map([["$and",(t,e)=>e.every(e=>g(t,e))],["$or",(t,e)=>e.some(e=>g(t,e))],["$not",(t,e)=>!g(t,e)],["$nor",(t,e)=>!e.some(e=>g(t,e))],["$eq",(t,e)=>t==e],["$ne",(t,e)=>t!=e],["$gt",(t,e)=>f(t)&&t>e],["$gte",(t,e)=>f(t)&&t>=e],["$lt",(t,e)=>f(t)&&t<e],["$lte",(t,e)=>f(t)&&t<=e],["$in",(t,e)=>e.has(t)],["$nin",(t,e)=>!e.has(t)]]),l=new Map,p=new Map;let h=[];function d(t){return new Promise((e,r)=>{t.fileReader.readText(t.datapackagePath,(n,o)=>{if(n)return r(new u.DdfCsvError(u.FILE_READING_ERROR,n,t.datapackagePath));let i;try{i=JSON.parse(o),h=[],function(t){if(p.size>0)return p;t.resources.forEach(t=>{Array.isArray(t.schema.primaryKey)||(t.schema.primaryKey=[t.schema.primaryKey]),t.translations={},p.set(t.name,t)})}(i),function(t){if(l.size>0)return l;for(const e in t.ddfSchema)t.ddfSchema[e].map(t=>{const e=k(t.primaryKey),r=t.resources.map(t=>p.get(t));l.has(e)?l.get(e).set(t.value,r):l.set(e,new Map([[t.value,r]]))})}(i)}catch(e){return r(new u.DdfCsvError(u.JSON_PARSING_ERROR,e.message,t.datapackagePath))}e(i)})})}async function _(t,r){y(e,r);const n={select:{key:["concept"],value:["concept_type","domain"]},from:"concepts",dataset:t.dataset,branch:t.branch,commit:t.commit};let o;try{!function(t,r){const n=t.filter(t=>"entity_set"===t.concept_type).map(t=>({concept:"is--"+t.concept,concept_type:"boolean",domain:null}));y(t=t.concat(n).concat(e),r)}(await b(n,r),r),o=await function({conceptsLookup:t}){const e=new Map([["boolean",t=>"true"===t||"TRUE"===t],["measure",t=>parseFloat(t)]]),r=[...O(["concept"])].map(r=>r.data.then(r=>{const n=Object.keys(r.data[0]),o=new Map;return n.forEach(r=>{const n=t.get(r).concept_type,i=e.get(n);i&&o.set(r,i)}),r.data.forEach(t=>{for(const[e,r]of o)t[e]=r(t[e])})}));return Promise.all(r)}(r)}catch(t){throw t}return o}function y(t,e){e.conceptsLookup.clear(),t.forEach(t=>e.conceptsLookup.set(t.concept,t))}async function v(t,e){let r;try{await c.validateQueryStructure(t,e),await c.extendQueryParamWithDatasetProps(t,e);const n=await d(e);if(e.datapackage=n,await _(t,e),await c.validateQueryDefinitions(t,e),c.isSchemaQuery(t))r=await function(t,{datapackage:e}){const r=t=>e.ddfSchema[t].map(({primaryKey:t,value:e})=>({key:t,value:e})),n=t.from.split(".")[0];return e.ddfSchema[n]?r(n):"*"===n?Object.keys(e.ddfSchema).map(r).reduce((t,e)=>t.concat(e)):void A(new u.DdfCsvError(u.DDF_ERROR,`No valid collection (${n}) for schema query`))}(t,{datapackage:n});else{const n=a.getAppropriatePlugin(t,e);if(n){h=[];const t=await n.getRecommendedFilesSet();h=t}r=await b(t,e)}}catch(t){throw t}return r}function b(t,e){const{select:{key:r=[],value:i=[]},from:a="",where:u={},join:c={},order_by:s=[],language:f}=t,l={key:r,value:i},p=new Set(l.key.concat(l.value)),h=j(u).filter(t=>!p.has(t)),d=function(t,e,r,o){const i=O(t,e);return Promise.all([...i].map(t=>(function(t,e,r){const o=[];void 0===t.data&&(t.data=T(r.datasetPath+"/"+t.path,r)),o.push(t.data);const i=void 0!==e&&n(function({datapackage:t}){return t.translations?t.translations.map(t=>t.id):[]}(r),e),a=void 0!==t.translations[e];if(i){if(!a){const n=`${r.datasetPath}/lang/${e}/${t.path}`;t.translations[e]=T(n,r).catch(t=>Promise.resolve({}))}o.push(t.translations[e])}return Promise.all(o).then(e=>{const r=e.map(t=>t.data||[]),n=t.schema.primaryKey,o=S(n,"translation",...r);return{data:o,resource:t}})})(t,r,o)))}(l.key,[...l.value,...h],f,e),_=function(t,e,r){return Promise.all(Object.keys(t).map(n=>(function(t,e,r,n){return"time"===n.conceptsLookup.get(e.key).concept_type?Promise.resolve({[t]:e.where}):v({select:{key:[e.key]},where:e.where,from:n.conceptsLookup.has(e.key)?"entities":"concepts",dataset:r.dataset,branch:r.branch,commit:r.commit},Object.assign({joinID:t},o(n))).then(r=>({[t]:{[e.key]:{$in:new Set(r.map(t=>t[e.key]))}}}))})(n,t[n],e,r))).then(t=>t.reduce(m,{}))}(c,t,e),y=function(t,e,r){const n=w(["entity_set"],t,r).map(t=>v({select:{key:[t.domain],value:["is--"+t.concept]},from:"entities",dataset:e.dataset,branch:e.branch,commit:e.commit},Object.assign({},o(r))).then(e=>({[t.concept]:{$in:new Set(e.filter(e=>e["is--"+t.concept]).map(e=>e[t.domain]))}})));return Promise.all(n).then(t=>t.reduce((t,e)=>Object.assign(t,e),{}))}(l.key,t,e);return Promise.all([d,y,_]).then(([t,r,o])=>{const i=function(...t){return t.reduce((t,e)=>(t.$and.push(e),t),{$and:[]})}(r,function t(e,r){const o={};for(const i in e){const a=e[i];n(["$and","$or","$nor"],i)?o[i]=a.map(e=>t(e,r)):"$in"===i||"$nin"===i?o[i]=new Set(a):void 0!==r[a]?Object.assign(o,r[a]):o[i]="object"==typeof a?t(a,r):a}return o}(u,o)),a=t.map(t=>(function(t,e,r,n){const o=t.resource.schema.primaryKey,i=new Set([...o,...e.value,...r]),a=function(t,e,r){const n=new Set(e),o=["entity_set","entity_domain"],i=w(o,t,r);if(0===i.length)return new Map;const a=w(o,null,r);return i.map(t=>a.filter(e=>"entity_set"===t.concept_type?n.has(e.concept)&&e.concept!==t.concept&&(e.domain===t.domain||e.concept===t.domain):n.has(e.concept)&&e.concept!==t.concept&&e.domain===t.concept).reduce((e,r)=>e.set(r.concept,t.concept),new Map)).reduce((t,e)=>new Map([...t,...e]),new Map)}(e.key,o,n);return t.data.map(t=>E(t,i)).map(t=>(function(t,e){const r={};for(const n in t)r[e.get(n)||n]=t[n];return r})(t,a))})(t,l,h,e)),c=S(l.key,"overwrite",...a).filter(t=>g(t,i)).map(t=>(function(t,e){for(const r of e)void 0===t[r]&&(t[r]=null);return t})(t,p)).map(t=>E(t,p));return function(t,e=[]){if(0===e.length)return;const r=e.map(t=>{if("string"==typeof t)return{concept:t,direction:1};{const e=Object.keys(t)[0],r="asc"===t[e]?1:-1;return{concept:e,direction:r}}}),n=r.length;t.sort((t,e)=>{for(let o=0;o<n;o++){const n=r[o];if(t[n.concept]<e[n.concept])return-1*n.direction;if(t[n.concept]>e[n.concept])return 1*n.direction}return 0})}(c,s),c})}function g(t,e){return Object.keys(e).every(n=>{const o=r.get(n);return o?o(t,e[n]):"object"!=typeof e[n]?r.get("$eq")(t[n],e[n]):g(t[n],e[n])})}function m(t,e){return Object.assign(t,e)}function j(t){const e=[];for(const r in t)n(["$and","$or","$not","$nor"],r)?t[r].map(j).forEach(t=>e.push(...t)):e.push(r);return e}function w(t,e,r){const o=e||Array.from(r.conceptsLookup.keys()),i=[];for(const e of o){const o=r.conceptsLookup.get(e);n(t,o.concept_type)&&i.push(o)}return i}function O(t,e){if(!e||0===e.length)return new Set([...l.get(k(t)).values()].reduce((t,e)=>t.concat(e)));if(Array.isArray(e))return e.map(e=>O(t,e)).reduce((t,e)=>new Set([...t,...e]),new Set);let r=l.get(k(t)).get(e);return r&&(r=r.filter(t=>i(h)||n(h,t.path))),new Set(r)}function E(t,e){const r={};for(const n in t)e.has(n)&&(r[n]=t[n]);return r}function S(t,e,...r){if(1===r.length)return r[0];const n=t.slice(0).sort();return[...r.reduce((t,r)=>(r.forEach(r=>{const o=n.map(t=>r[t]).join(",");t.has(o)?function(t,e,r){switch(r){case"overwrite":Object.assign(t,e);break;case"translation":for(const r in e)""!==e[r]&&(t[r]=e[r]);break;case"overwriteWithError":for(const r in e)if(void 0!==t[r]&&t[r]!==e[r]){const n=JSON.stringify(e),o=JSON.stringify(t),i=`JOIN Error: two resources have different data for "${r}": ${n},${o}`;A(new u.DdfCsvError(u.DDF_ERROR,i))}else t[r]=e[r]}}(t.get(o),r,e):t.set(o,r)}),t),new Map).values()]}function A(e){throw(t||console).error(e.message),e}function k(t,e=!1){const r=t.slice(0).sort();return e?r.map(t=>e[t]).join(","):r.join(",")}function T(t,e){return new Promise((r,o)=>{e.fileReader.readText(t,(i,a)=>{if(i)return o(new u.DdfCsvError(u.FILE_READING_ERROR,i,t));s.parse(a,{header:!0,skipEmptyLines:!0,dynamicTyping:t=>{if(!e.conceptsLookup)return!0;const r=e.conceptsLookup.get(t)||{};return n(["boolean","measure"],r.concept_type)},complete:t=>r(t),error:e=>o(new u.DdfCsvError(u.CSV_PARSING_ERROR,e,t))})})})}return{query:v}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(5),o=r(11),i=r(40),a=r(6);e.prepareDDFCsvReaderObject=function(t){return function(e,r){return{init(o){this._basePath=o.path,this._lastModified=o._lastModified,this.fileReader=e||t,this.logger=r,this.resultTransformer=o.resultTransformer,this.datasetsConfig=o.datasetsConfig,this.isLocalReader=!!n(this.datasetsConfig),this.isServerReader=!this.isLocalReader,this.readerOptions={basePath:this._basePath,fileReader:this.fileReader,logger:this.logger,datasetsConfig:this.datasetsConfig},this.reader=i.ddfCsvReader(this.logger)},getAsset(t){const e=".json"===t.slice(-".json".length);let r=`${this._basePath}/${t}`;return o(t)&&(r=a.getDatasetPath(this._basePath,t)),new Promise((t,n)=>{this.fileReader.readText(r,(r,o)=>{if(r)n(r);else if(e)try{t(JSON.parse(o))}catch(t){n(r)}else t(o)})})},async read(t,e){let n;try{n=await this.reader.query(t,{basePath:this._basePath,datasetsConfig:this.datasetsConfig,fileReader:this.fileReader,logger:this.logger,conceptsLookup:new Map,datapackagePath:"",datasetPath:"",dataset:""}),n=e?this._prettifyData(n,e):n,this.resultTransformer&&(n=this.resultTransformer(n)),this.logger&&this.logger.log&&(r.log(JSON.stringify(t),n.length),r.log(n))}catch(t){throw t}return n},_prettifyData:(t,e)=>t.map(t=>(Object.keys(t).forEach(r=>{e[r]&&(t[r]=e[r](t[r]))}),t))}}}},function(t,e){t.exports=require("fs")},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=r(21);var o=r(21);e.BackendFileReader=o.BackendFileReader;const i=r(20);var a=r(20);e.GithubFileReader=a.GithubFileReader;var u=r(12);e.DdfCsvError=u.DdfCsvError;const c=r(41);e.getDDFCsvReaderObject=c.prepareDDFCsvReaderObject(new n.BackendFileReader),e.getGithubDDFCsvReaderObject=c.prepareDDFCsvReaderObject(new i.GithubFileReader)}]));
//# sourceMappingURL=vizabi-ddfcsv-reader-node.js.map